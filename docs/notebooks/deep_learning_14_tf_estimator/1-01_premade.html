<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Copyright 2019 The TensorFlow Authors. &mdash; documentación de Cursos de Analítica y Machine Learning - </title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Cursos de Analítica y Machine Learning
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Pregrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html">Redes Neuronales Artificiales y Aprendizaje Profundo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentos_de_analitica/index.html">Fundamentos de Analítica</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Posgrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../analitica_de_grandes_datos/index.html">Analítica de Grandes Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica_predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ciencia_de_los_datos/index.html">Ciencia de los Datos Aplicada</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../productos_de_datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica_avanzada/index.html">Analítica Avanzada</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cursos de Analítica y Machine Learning</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Copyright 2019 The TensorFlow Authors.</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/deep_learning_14_tf_estimator/1-01_premade.ipynb.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Copyright-2019-The-TensorFlow-Authors.">
<h1>Copyright 2019 The TensorFlow Authors.<a class="headerlink" href="#Copyright-2019-The-TensorFlow-Authors." title="Enlazar permanentemente con este título"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>#@title Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
</pre></div>
</div>
</div>
<div class="section" id="Premade-Estimators">
<h2>Premade Estimators<a class="headerlink" href="#Premade-Estimators" title="Enlazar permanentemente con este título"></a></h2>
<table class="tfo-notebook-buttons" align="left"><td><p><a href="#id1"><span class="problematic" id="id2">|</span></a>0aa7b8d4112a4e13ad1cf8f86f491965|View on TensorFlow.org</p>
</td><td><p><a href="#id3"><span class="problematic" id="id4">|</span></a>cb5804a720ea43a6bf278859fb747d14|Run in Google Colab</p>
</td><td><p><a href="#id5"><span class="problematic" id="id6">|</span></a>5489085de2344dd58f008db9163a64ed|View source on GitHub</p>
</td><td><p><a href="#id7"><span class="problematic" id="id8">|</span></a>2638bf003e3e459e947303c80948c238|Download notebook</p>
</td></table><blockquote>
<div><p>Warning: Estimators are not recommended for new code. Estimators run <code class="docutils literal notranslate"><span class="pre">v1.Session</span></code>-style code which is more difficult to write correctly, and can behave unexpectedly, especially when combined with TF 2 code. Estimators do fall under <a class="reference external" href="https://tensorflow.org/guide/versions">compatibility guarantees</a>, but will receive no fixes other than security vulnerabilities. See the <a class="reference external" href="https://tensorflow.org/guide/migrate">migration guide</a> for details.</p>
</div></blockquote>
<p>This tutorial shows you how to solve the Iris classification problem in TensorFlow using Estimators. An Estimator is a legacy TensorFlow high-level representation of a complete model. For more details see <a class="reference external" href="https://www.tensorflow.org/guide/estimator">Estimators</a>.</p>
<p>Note: In TensorFlow 2.0, the <a class="reference external" href="https://www.tensorflow.org/guide/keras">Keras API</a> can accomplish these same tasks, and is believed to be an easier API to learn. If you are starting fresh, it is recommended you start with Keras.</p>
<div class="section" id="First-things-first">
<h3>First things first<a class="headerlink" href="#First-things-first" title="Enlazar permanentemente con este título"></a></h3>
<p>In order to get started, you will first import TensorFlow and a number of libraries you will need.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>import tensorflow as tf

import pandas as pd
</pre></div>
</div>
</div>
</div>
<div class="section" id="The-data-set">
<h3>The data set<a class="headerlink" href="#The-data-set" title="Enlazar permanentemente con este título"></a></h3>
<p>The sample program in this document builds and tests a model that classifies Iris flowers into three different species based on the size of their <a class="reference external" href="https://en.wikipedia.org/wiki/Sepal">sepals</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Petal">petals</a>.</p>
<p>You will train a model using the Iris data set. The Iris data set contains four features and one <a class="reference external" href="https://developers.google.com/machine-learning/glossary/#label">label</a>. The four features identify the following botanical characteristics of individual Iris flowers:</p>
<ul class="simple">
<li><p>sepal length</p></li>
<li><p>sepal width</p></li>
<li><p>petal length</p></li>
<li><p>petal width</p></li>
</ul>
<p>Based on this information, you can define a few helpful constants for parsing the data:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>CSV_COLUMN_NAMES = [&#39;SepalLength&#39;, &#39;SepalWidth&#39;, &#39;PetalLength&#39;, &#39;PetalWidth&#39;, &#39;Species&#39;]
SPECIES = [&#39;Setosa&#39;, &#39;Versicolor&#39;, &#39;Virginica&#39;]
</pre></div>
</div>
</div>
<p>Next, download and parse the Iris data set using Keras and Pandas. Note that you keep distinct datasets for training and testing.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>train_path = tf.keras.utils.get_file(
    &quot;iris_training.csv&quot;, &quot;https://storage.googleapis.com/download.tensorflow.org/data/iris_training.csv&quot;)
test_path = tf.keras.utils.get_file(
    &quot;iris_test.csv&quot;, &quot;https://storage.googleapis.com/download.tensorflow.org/data/iris_test.csv&quot;)

train = pd.read_csv(train_path, names=CSV_COLUMN_NAMES, header=0)
test = pd.read_csv(test_path, names=CSV_COLUMN_NAMES, header=0)
</pre></div>
</div>
</div>
<p>You can inspect your data to see that you have four float feature columns and one int32 label.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>train.head()
</pre></div>
</div>
</div>
<p>For each of the datasets, split out the labels, which the model will be trained to predict.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>train_y = train.pop(&#39;Species&#39;)
test_y = test.pop(&#39;Species&#39;)

# The label column has now been removed from the features.
train.head()
</pre></div>
</div>
</div>
</div>
<div class="section" id="Overview-of-programming-with-Estimators">
<h3>Overview of programming with Estimators<a class="headerlink" href="#Overview-of-programming-with-Estimators" title="Enlazar permanentemente con este título"></a></h3>
<p>Now that you have the data set up, you can define a model using a TensorFlow Estimator. An Estimator is any class derived from <code class="docutils literal notranslate"><span class="pre">tf.estimator.Estimator</span></code>. TensorFlow provides a collection of <code class="docutils literal notranslate"><span class="pre">tf.estimator</span></code> (for example, <code class="docutils literal notranslate"><span class="pre">LinearRegressor</span></code>) to implement common ML algorithms. Beyond those, you may write your own <a class="reference external" href="https://www.tensorflow.org/guide/estimator#custom_estimators">custom Estimators</a>. It is recommended using pre-made Estimators when just getting started.</p>
<p>To write a TensorFlow program based on pre-made Estimators, you must perform the following tasks:</p>
<ul class="simple">
<li><p>Create one or more input functions.</p></li>
<li><p>Define the model’s feature columns.</p></li>
<li><p>Instantiate an Estimator, specifying the feature columns and various hyperparameters.</p></li>
<li><p>Call one or more methods on the Estimator object, passing the appropriate input function as the source of the data.</p></li>
</ul>
<p>Let’s see how those tasks are implemented for Iris classification.</p>
</div>
<div class="section" id="Create-input-functions">
<h3>Create input functions<a class="headerlink" href="#Create-input-functions" title="Enlazar permanentemente con este título"></a></h3>
<p>You must create input functions to supply data for training, evaluating, and prediction.</p>
<p>An <strong>input function</strong> is a function that returns a <code class="docutils literal notranslate"><span class="pre">tf.data.Dataset</span></code> object which outputs the following two-element tuple:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">`features</span></code> &lt;<a class="reference external" href="https://developers.google.com/machine-learning/glossary/#feature">https://developers.google.com/machine-learning/glossary/#feature</a>&gt;`__ - A Python dictionary in which:</p>
<ul>
<li><p>Each key is the name of a feature.</p></li>
<li><p>Each value is an array containing all of that feature’s values.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">label</span></code> - An array containing the values of the <a class="reference external" href="https://developers.google.com/machine-learning/glossary/#label">label</a> for every example.</p></li>
</ul>
<p>Just to demonstrate the format of the input function, here’s a simple implementation:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>def input_evaluation_set():
    features = {&#39;SepalLength&#39;: np.array([6.4, 5.0]),
                &#39;SepalWidth&#39;:  np.array([2.8, 2.3]),
                &#39;PetalLength&#39;: np.array([5.6, 3.3]),
                &#39;PetalWidth&#39;:  np.array([2.2, 1.0])}
    labels = np.array([2, 1])
    return features, labels
</pre></div>
</div>
</div>
<p>Your input function may generate the <code class="docutils literal notranslate"><span class="pre">features</span></code> dictionary and <code class="docutils literal notranslate"><span class="pre">label</span></code> list any way you like. However, It is recommended using TensorFlow’s <a class="reference external" href="https://www.tensorflow.org/guide/datasets">Dataset API</a>, which can parse all sorts of data.</p>
<p>The Dataset API can handle a lot of common cases for you. For example, using the Dataset API, you can easily read in records from a large collection of files in parallel and join them into a single stream.</p>
<p>To keep things simple in this example you are going to load the data with <a class="reference external" href="https://pandas.pydata.org/">pandas</a>, and build an input pipeline from this in-memory data:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>def input_fn(features, labels, training=True, batch_size=256):
    &quot;&quot;&quot;An input function for training or evaluating&quot;&quot;&quot;
    # Convert the inputs to a Dataset.
    dataset = tf.data.Dataset.from_tensor_slices((dict(features), labels))

    # Shuffle and repeat if you are in training mode.
    if training:
        dataset = dataset.shuffle(1000).repeat()

    return dataset.batch(batch_size)

</pre></div>
</div>
</div>
</div>
<div class="section" id="Define-the-feature-columns">
<h3>Define the feature columns<a class="headerlink" href="#Define-the-feature-columns" title="Enlazar permanentemente con este título"></a></h3>
<p>A <a class="reference external" href="https://developers.google.com/machine-learning/glossary/#feature_columns">feature column</a> is an object describing how the model should use raw input data from the features dictionary. When you build an Estimator model, you pass it a list of feature columns that describes each of the features you want the model to use. The <code class="docutils literal notranslate"><span class="pre">tf.feature_column</span></code> module provides many options for representing data to the model.</p>
<p>For Iris, the 4 raw features are numeric values, so you’ll build a list of feature columns to tell the Estimator model to represent each of the four features as 32-bit floating-point values. Therefore, the code to create the feature column is:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span># Feature columns describe how to use the input.
my_feature_columns = []
for key in train.keys():
    my_feature_columns.append(tf.feature_column.numeric_column(key=key))
</pre></div>
</div>
</div>
<p>Feature columns can be far more sophisticated than those shown here. You can read more about Feature Columns in <a class="reference external" href="https://www.tensorflow.org/guide/feature_columns">this guide</a>.</p>
<p>Now that you have the description of how you want the model to represent the raw features, you can build the estimator.</p>
</div>
<div class="section" id="Instantiate-an-estimator">
<h3>Instantiate an estimator<a class="headerlink" href="#Instantiate-an-estimator" title="Enlazar permanentemente con este título"></a></h3>
<p>The Iris problem is a classic classification problem. Fortunately, TensorFlow provides several pre-made classifier Estimators, including:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tf.estimator.DNNClassifier</span></code> for deep models that perform multi-class classification.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tf.estimator.DNNLinearCombinedClassifier</span></code> for wide &amp; deep models.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tf.estimator.LinearClassifier</span></code> for classifiers based on linear models.</p></li>
</ul>
<p>For the Iris problem, <code class="docutils literal notranslate"><span class="pre">tf.estimator.DNNClassifier</span></code> seems like the best choice. Here’s how you instantiated this Estimator:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span># Build a DNN with 2 hidden layers with 30 and 10 hidden nodes each.
classifier = tf.estimator.DNNClassifier(
    feature_columns=my_feature_columns,
    # Two hidden layers of 30 and 10 nodes respectively.
    hidden_units=[30, 10],
    # The model must choose between 3 classes.
    n_classes=3)
</pre></div>
</div>
</div>
</div>
<div class="section" id="Train,-Evaluate,-and-Predict">
<h3>Train, Evaluate, and Predict<a class="headerlink" href="#Train,-Evaluate,-and-Predict" title="Enlazar permanentemente con este título"></a></h3>
<p>Now that you have an Estimator object, you can call methods to do the following:</p>
<ul class="simple">
<li><p>Train the model.</p></li>
<li><p>Evaluate the trained model.</p></li>
<li><p>Use the trained model to make predictions.</p></li>
</ul>
<div class="section" id="Train-the-model">
<h4>Train the model<a class="headerlink" href="#Train-the-model" title="Enlazar permanentemente con este título"></a></h4>
<p>Train the model by calling the Estimator’s <code class="docutils literal notranslate"><span class="pre">train</span></code> method as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span># Train the Model.
classifier.train(
    input_fn=lambda: input_fn(train, train_y, training=True),
    steps=5000)
</pre></div>
</div>
</div>
<p>Note that you wrap up your <code class="docutils literal notranslate"><span class="pre">input_fn</span></code> call in a <code class="docutils literal notranslate"><span class="pre">`lambda</span></code> &lt;<a class="reference external" href="https://docs.python.org/3/tutorial/controlflow.html">https://docs.python.org/3/tutorial/controlflow.html</a>&gt;`__ to capture the arguments while providing an input function that takes no arguments, as expected by the Estimator. The <code class="docutils literal notranslate"><span class="pre">steps</span></code> argument tells the method to stop training after a number of training steps.</p>
</div>
<div class="section" id="Evaluate-the-trained-model">
<h4>Evaluate the trained model<a class="headerlink" href="#Evaluate-the-trained-model" title="Enlazar permanentemente con este título"></a></h4>
<p>Now that the model has been trained, you can get some statistics on its performance. The following code block evaluates the accuracy of the trained model on the test data:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>eval_result = classifier.evaluate(
    input_fn=lambda: input_fn(test, test_y, training=False))

print(&#39;\nTest set accuracy: {accuracy:0.3f}\n&#39;.format(**eval_result))
</pre></div>
</div>
</div>
<p>Unlike the call to the <code class="docutils literal notranslate"><span class="pre">train</span></code> method, you did not pass the <code class="docutils literal notranslate"><span class="pre">steps</span></code> argument to evaluate. The <code class="docutils literal notranslate"><span class="pre">input_fn</span></code> for eval only yields a single <a class="reference external" href="https://developers.google.com/machine-learning/glossary/#epoch">epoch</a> of data.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">eval_result</span></code> dictionary also contains the <code class="docutils literal notranslate"><span class="pre">average_loss</span></code> (mean loss per sample), the <code class="docutils literal notranslate"><span class="pre">loss</span></code> (mean loss per mini-batch) and the value of the estimator’s <code class="docutils literal notranslate"><span class="pre">global_step</span></code> (the number of training iterations it underwent).</p>
</div>
<div class="section" id="Making-predictions-(inferring)-from-the-trained-model">
<h4>Making predictions (inferring) from the trained model<a class="headerlink" href="#Making-predictions-(inferring)-from-the-trained-model" title="Enlazar permanentemente con este título"></a></h4>
<p>You now have a trained model that produces good evaluation results. You can now use the trained model to predict the species of an Iris flower based on some unlabeled measurements. As with training and evaluation, you make predictions using a single function call:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span># Generate predictions from the model
expected = [&#39;Setosa&#39;, &#39;Versicolor&#39;, &#39;Virginica&#39;]
predict_x = {
    &#39;SepalLength&#39;: [5.1, 5.9, 6.9],
    &#39;SepalWidth&#39;: [3.3, 3.0, 3.1],
    &#39;PetalLength&#39;: [1.7, 4.2, 5.4],
    &#39;PetalWidth&#39;: [0.5, 1.5, 2.1],
}

def input_fn(features, batch_size=256):
    &quot;&quot;&quot;An input function for prediction.&quot;&quot;&quot;
    # Convert the inputs to a Dataset without labels.
    return tf.data.Dataset.from_tensor_slices(dict(features)).batch(batch_size)

predictions = classifier.predict(
    input_fn=lambda: input_fn(predict_x))
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">predict</span></code> method returns a Python iterable, yielding a dictionary of prediction results for each example. The following code prints a few predictions and their probabilities:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>for pred_dict, expec in zip(predictions, expected):
    class_id = pred_dict[&#39;class_ids&#39;][0]
    probability = pred_dict[&#39;probabilities&#39;][class_id]

    print(&#39;Prediction is &quot;{}&quot; ({:.1f}%), expected &quot;{}&quot;&#39;.format(
        SPECIES[class_id], 100 * probability, expec))
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2019-2021, Juan D. Velasquez.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>