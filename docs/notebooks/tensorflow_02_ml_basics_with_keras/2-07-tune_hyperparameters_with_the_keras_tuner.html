<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Afinación de parámetros con Keras Tuner — 21:03 min &mdash; documentación de Cursos de Analítica y Machine Learning - </title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Cursos de Analítica y Machine Learning
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Asignaturas de Pregrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../redes_neuronales/index.html">Redes Neuronales Artificiales y Aprendizaje Profundo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentos_de_analitica/index.html">Fundamentos de Analítica</a></li>
</ul>
<p class="caption"><span class="caption-text">Asignaturas de Posgrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ciencia_de_los_datos/index.html">Ciencia de los Datos Aplicada</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica_predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica_de_grandes_datos/index.html">Analítica de Grandes Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../productos_de_datos/index.html">Productos de Datos</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cursos de Analítica y Machine Learning</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Afinación de parámetros con Keras Tuner — 21:03 min</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/tensorflow_02_ml_basics_with_keras/2-07-tune_hyperparameters_with_the_keras_tuner.ipynb.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Afinación-de-parámetros-con-Keras-Tuner-—-21:03-min">
<h1>Afinación de parámetros con Keras Tuner — 21:03 min<a class="headerlink" href="#Afinación-de-parámetros-con-Keras-Tuner-—-21:03-min" title="Enlazar permanentemente con este título"></a></h1>
<ul class="simple">
<li><p>Última modificación: Mayo 10, 2021 | <a class="reference external" href="https://youtu.be/5IL3etLzVGk">YouTube</a></p></li>
</ul>
<p>Adaptado de:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.tensorflow.org/tutorials/keras/keras_tuner">https://www.tensorflow.org/tutorials/keras/keras_tuner</a></p></li>
</ul>
<p>En la construcción de modelos de redes neuronales siempre se busca encontrar el mejor modelo en términos de la precisión del pronóstico. Sin embargo, el desempeño de un modelo de redes neuronales depende de su arquitectura (cantidad de capas y cantidad de neuronas por capa, funciones de activación) y del proceso de entrenamiento (algoritmo usado, número de iteraciones, tasa de aprendizaje, etc.). Keras Tuner es una librería que implementa varios algoritmos de búsqueda para encontrar la mejor
combinación de parámetros relacionados con la arquitectura y el entrenamiento de una red neuronal. En esta lección se explican los fundamentos de Keras Tuner y como aplicarlo para la obtención del mejor modelo.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">keras_tuner</span> <span class="k">as</span> <span class="nn">kt</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>

<span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2.5.0
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  Descarga de los datos</span>
<span class="c1">#</span>
<span class="p">(</span>
    <span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">),</span>
    <span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">),</span>
<span class="p">)</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">fashion_mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="Especificación-del-modelo">
<h2>Especificación del modelo<a class="headerlink" href="#Especificación-del-modelo" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">model_builder</span><span class="p">(</span><span class="n">hp</span><span class="p">):</span>

    <span class="c1">#</span>
    <span class="c1"># Evalua distintas cantidades de neuronas en la capa</span>
    <span class="c1"># oculta</span>
    <span class="c1">#</span>
    <span class="n">hp_units</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">Int</span><span class="p">(</span>
        <span class="s2">&quot;units&quot;</span><span class="p">,</span>
        <span class="n">min_value</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
        <span class="n">max_value</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
        <span class="n">step</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="c1">#</span>
            <span class="c1"># Esta capa reduce una dimension de la matriz de entrada.</span>
            <span class="c1"># El conjunto de entrada es una lista de matrices de 28x28.</span>
            <span class="c1"># Flatten genera una lista de vectores de dimensión 28x28</span>
            <span class="c1">#</span>
            <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>

            <span class="c1">#</span>
            <span class="c1"># Preprocesamiento de la entrada [0, 255] --&gt; [0, 1]</span>
            <span class="c1">#</span>
            <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">Rescaling</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span>

            <span class="c1">#</span>
            <span class="c1"># Capa de procesamiento. Aquí se modifica dinamicamente la</span>
            <span class="c1"># cantidad de neuronas en la capa</span>
            <span class="c1">#</span>
            <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
                <span class="n">units</span><span class="o">=</span><span class="n">hp_units</span><span class="p">,</span>
                <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
            <span class="p">),</span>

            <span class="c1">#</span>
            <span class="c1"># Capa de salida</span>
            <span class="c1">#</span>
            <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Escoge el mejor valor para la tasa de aprendizaje</span>
    <span class="c1">#</span>
    <span class="n">hp_learning_rate</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">Choice</span><span class="p">(</span>
        <span class="s2">&quot;learning_rate&quot;</span><span class="p">,</span>
        <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="c1">#</span>
        <span class="c1"># Optimizador con distintos valores</span>
        <span class="c1"># para la tasa de aprendizaje</span>
        <span class="c1">#</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span>
            <span class="n">learning_rate</span><span class="o">=</span><span class="n">hp_learning_rate</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="c1">#</span>
        <span class="c1"># Función de pérdida</span>
        <span class="c1">#</span>
        <span class="n">loss</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span>
            <span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="c1">#</span>
        <span class="c1"># Métrica a monitoreas</span>
        <span class="c1">#</span>
        <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Monitoreo-del-modelo-con-Early-Stopping">
<h2>Monitoreo del modelo con Early Stopping<a class="headerlink" href="#Monitoreo-del-modelo-con-Early-Stopping" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">callbacks</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span>
        <span class="c1">#</span>
        <span class="c1"># Metrica a monitorear</span>
        <span class="c1">#</span>
        <span class="n">monitor</span><span class="o">=</span><span class="s2">&quot;val_loss&quot;</span><span class="p">,</span>

        <span class="c1">#</span>
        <span class="c1"># Número de iteraciones sin mejora antes</span>
        <span class="c1"># de finalizar el entrenamiento</span>
        <span class="c1">#</span>
        <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Búsqueda-usando-HyperBand">
<h2>Búsqueda usando HyperBand<a class="headerlink" href="#Búsqueda-usando-HyperBand" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>rm -rf /tmp/hyperband_kt

<span class="n">hyperband_tuner</span> <span class="o">=</span> <span class="n">kt</span><span class="o">.</span><span class="n">Hyperband</span><span class="p">(</span>
    <span class="n">hypermodel</span><span class="o">=</span><span class="n">model_builder</span><span class="p">,</span>      <span class="c1"># construye el modelo</span>
    <span class="n">objective</span><span class="o">=</span><span class="s2">&quot;val_accuracy&quot;</span><span class="p">,</span>      <span class="c1"># criterio para seleccionar los parametros</span>
    <span class="n">max_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>                 <span class="c1"># Número máximo de iteraciones</span>
    <span class="n">factor</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>                      <span class="c1"># factor para reducir la cantidad de modelos</span>
    <span class="n">directory</span><span class="o">=</span><span class="s2">&quot;/tmp/hyperband_kt&quot;</span><span class="p">,</span> <span class="c1"># directorio de trabajo</span>
    <span class="n">project_name</span><span class="o">=</span><span class="s2">&quot;hyperband_kt&quot;</span><span class="p">,</span>   <span class="c1"># nombre del proyecto</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                <span class="c1"># sobre-escribe la carpeta si existe</span>
<span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Resumen de los parametros de la búsqueda</span>
<span class="c1">#</span>
<span class="n">hyperband_tuner</span><span class="o">.</span><span class="n">search_space_summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Search space summary
Default search space size: 2
units (Int)
{&#39;default&#39;: None, &#39;conditions&#39;: [], &#39;min_value&#39;: 32, &#39;max_value&#39;: 512, &#39;step&#39;: 32, &#39;sampling&#39;: None}
learning_rate (Choice)
{&#39;default&#39;: 0.01, &#39;conditions&#39;: [], &#39;values&#39;: [0.01, 0.001, 0.0001], &#39;ordered&#39;: True}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hyperband_tuner</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
    <span class="n">train_images</span><span class="p">,</span>
    <span class="n">train_labels</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">hyperband_tuner</span><span class="o">.</span><span class="n">results_summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Trial 30 Complete [00h 00m 55s]
val_accuracy: 0.8912500143051147

Best val_accuracy So Far: 0.8912500143051147
Total elapsed time: 00h 09m 20s
INFO:tensorflow:Oracle triggered exit
Results summary
Results in /tmp/hyperband_kt/hyperband_kt
Showing 10 best trials
Objective(name=&#39;val_accuracy&#39;, direction=&#39;max&#39;)
Trial summary
Hyperparameters:
units: 352
learning_rate: 0.001
tuner/epochs: 10
tuner/initial_epoch: 0
tuner/bracket: 0
tuner/round: 0
Score: 0.8912500143051147
Trial summary
Hyperparameters:
units: 224
learning_rate: 0.001
tuner/epochs: 10
tuner/initial_epoch: 0
tuner/bracket: 0
tuner/round: 0
Score: 0.8896666765213013
Trial summary
Hyperparameters:
units: 192
learning_rate: 0.001
tuner/epochs: 10
tuner/initial_epoch: 0
tuner/bracket: 0
tuner/round: 0
Score: 0.8864166736602783
Trial summary
Hyperparameters:
units: 160
learning_rate: 0.001
tuner/epochs: 10
tuner/initial_epoch: 4
tuner/bracket: 1
tuner/round: 1
tuner/trial_id: 422bccbb6eb9a85556e5cac0b0191ae0
Score: 0.8857499957084656
Trial summary
Hyperparameters:
units: 384
learning_rate: 0.001
tuner/epochs: 10
tuner/initial_epoch: 4
tuner/bracket: 1
tuner/round: 1
tuner/trial_id: dc9054df59a684274b3100927053c4df
Score: 0.8856666684150696
Trial summary
Hyperparameters:
units: 320
learning_rate: 0.001
tuner/epochs: 10
tuner/initial_epoch: 4
tuner/bracket: 2
tuner/round: 2
tuner/trial_id: 869c98f85e280944338bf8995e02354f
Score: 0.8854166865348816
Trial summary
Hyperparameters:
units: 384
learning_rate: 0.001
tuner/epochs: 4
tuner/initial_epoch: 0
tuner/bracket: 1
tuner/round: 0
Score: 0.8794166445732117
Trial summary
Hyperparameters:
units: 384
learning_rate: 0.0001
tuner/epochs: 10
tuner/initial_epoch: 4
tuner/bracket: 2
tuner/round: 2
tuner/trial_id: 323abbff79597539712beb0f24778232
Score: 0.8711666464805603
Trial summary
Hyperparameters:
units: 320
learning_rate: 0.001
tuner/epochs: 2
tuner/initial_epoch: 0
tuner/bracket: 2
tuner/round: 0
Score: 0.8705833554267883
Trial summary
Hyperparameters:
units: 160
learning_rate: 0.001
tuner/epochs: 4
tuner/initial_epoch: 0
tuner/bracket: 1
tuner/round: 0
Score: 0.8700833320617676
</pre></div></div>
</div>
</div>
<div class="section" id="Búsqueda-usando-random-search">
<h2>Búsqueda usando random search<a class="headerlink" href="#Búsqueda-usando-random-search" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>rm -rf /tmp/randomsearch_kt

<span class="n">randomsearch_tuner</span> <span class="o">=</span> <span class="n">kt</span><span class="o">.</span><span class="n">RandomSearch</span><span class="p">(</span>
    <span class="n">hypermodel</span><span class="o">=</span><span class="n">model_builder</span><span class="p">,</span>         <span class="c1"># construye el modelo</span>
    <span class="n">objective</span><span class="o">=</span><span class="s2">&quot;val_accuracy&quot;</span><span class="p">,</span>         <span class="c1"># criterio para seleccionar los parametros</span>
    <span class="n">max_trials</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>                     <span class="c1"># número máximo de ensayos</span>
    <span class="n">directory</span><span class="o">=</span><span class="s2">&quot;/tmp/randomsearch_kt&quot;</span><span class="p">,</span> <span class="c1"># directorio de trabajo</span>
    <span class="n">project_name</span><span class="o">=</span><span class="s2">&quot;randomsearch_kt&quot;</span><span class="p">,</span>   <span class="c1"># Nombre del proyecto</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                   <span class="c1"># sobre-escribe la carpeta si existe</span>
<span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Resumen de los parametros de la búsqueda</span>
<span class="c1">#</span>
<span class="n">randomsearch_tuner</span><span class="o">.</span><span class="n">search_space_summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Search space summary
Default search space size: 2
units (Int)
{&#39;default&#39;: None, &#39;conditions&#39;: [], &#39;min_value&#39;: 32, &#39;max_value&#39;: 512, &#39;step&#39;: 32, &#39;sampling&#39;: None}
learning_rate (Choice)
{&#39;default&#39;: 0.01, &#39;conditions&#39;: [], &#39;values&#39;: [0.01, 0.001, 0.0001], &#39;ordered&#39;: True}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">randomsearch_tuner</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
    <span class="n">train_images</span><span class="p">,</span>
    <span class="n">train_labels</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">randomsearch_tuner</span><span class="o">.</span><span class="n">results_summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Trial 4 Complete [00h 01m 39s]
val_accuracy: 0.8943333625793457

Best val_accuracy So Far: 0.8955833315849304
Total elapsed time: 00h 10m 52s
INFO:tensorflow:Oracle triggered exit
Results summary
Results in /tmp/randomsearch_kt/randomsearch_kt
Showing 10 best trials
Objective(name=&#39;val_accuracy&#39;, direction=&#39;max&#39;)
Trial summary
Hyperparameters:
units: 352
learning_rate: 0.0001
Score: 0.8955833315849304
Trial summary
Hyperparameters:
units: 416
learning_rate: 0.0001
Score: 0.8945833444595337
Trial summary
Hyperparameters:
units: 256
learning_rate: 0.001
Score: 0.8943333625793457
Trial summary
Hyperparameters:
units: 256
learning_rate: 0.01
Score: 0.8689166903495789
</pre></div></div>
</div>
</div>
<div class="section" id="Búsqueda-usando-Bayesian-Optimization">
<h2>Búsqueda usando Bayesian Optimization<a class="headerlink" href="#Búsqueda-usando-Bayesian-Optimization" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>rm -rf /tmp/bayesianopt_kt

<span class="n">bayesianoptimization_tuner</span> <span class="o">=</span> <span class="n">kt</span><span class="o">.</span><span class="n">BayesianOptimization</span><span class="p">(</span>
    <span class="n">hypermodel</span><span class="o">=</span><span class="n">model_builder</span><span class="p">,</span>         <span class="c1"># construye el modelo</span>
    <span class="n">objective</span><span class="o">=</span><span class="s2">&quot;val_accuracy&quot;</span><span class="p">,</span>         <span class="c1"># criterio para seleccionar los parametros</span>
    <span class="n">max_trials</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>                     <span class="c1"># número máximo de ensayos</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">,</span>                      <span class="c1"># semilla del generador de aleatorios</span>
    <span class="n">directory</span><span class="o">=</span><span class="s2">&quot;/tmp/bayesianopt_kt&quot;</span><span class="p">,</span>  <span class="c1"># directorio de trabajo</span>
    <span class="n">project_name</span><span class="o">=</span><span class="s2">&quot;bayesianopt_kt&quot;</span><span class="p">,</span>    <span class="c1"># Nombre del proyecto</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                   <span class="c1"># sobre-escribe la carpeta si existe</span>
<span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Resumen de los parametros de la búsqueda</span>
<span class="c1">#</span>
<span class="n">bayesianoptimization_tuner</span><span class="o">.</span><span class="n">search_space_summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Search space summary
Default search space size: 2
units (Int)
{&#39;default&#39;: None, &#39;conditions&#39;: [], &#39;min_value&#39;: 32, &#39;max_value&#39;: 512, &#39;step&#39;: 32, &#39;sampling&#39;: None}
learning_rate (Choice)
{&#39;default&#39;: 0.01, &#39;conditions&#39;: [], &#39;values&#39;: [0.01, 0.001, 0.0001], &#39;ordered&#39;: True}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bayesianoptimization_tuner</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
    <span class="n">train_images</span><span class="p">,</span>
    <span class="n">train_labels</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">bayesianoptimization_tuner</span><span class="o">.</span><span class="n">results_summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Trial 4 Complete [00h 05m 27s]
val_accuracy: 0.8993333578109741

Best val_accuracy So Far: 0.8993333578109741
Total elapsed time: 00h 11m 06s
INFO:tensorflow:Oracle triggered exit
Results summary
Results in /tmp/bayesianopt_kt/bayesianopt_kt
Showing 10 best trials
Objective(name=&#39;val_accuracy&#39;, direction=&#39;max&#39;)
Trial summary
Hyperparameters:
units: 512
learning_rate: 0.0001
Score: 0.8993333578109741
Trial summary
Hyperparameters:
units: 416
learning_rate: 0.001
Score: 0.8896666765213013
Trial summary
Hyperparameters:
units: 128
learning_rate: 0.0001
Score: 0.8810833096504211
Trial summary
Hyperparameters:
units: 512
learning_rate: 0.01
Score: 0.8696666955947876
</pre></div></div>
</div>
</div>
<div class="section" id="Obtención-de-los-mejores-hiperparámetros">
<h2>Obtención de los mejores hiperparámetros<a class="headerlink" href="#Obtención-de-los-mejores-hiperparámetros" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">best_hyperband_hps</span> <span class="o">=</span> <span class="n">hyperband_tuner</span><span class="o">.</span><span class="n">get_best_hyperparameters</span><span class="p">(</span><span class="n">num_trials</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#</span>
<span class="c1"># Cantidad optima de neuronas en la capa oculta</span>
<span class="c1"># y tasa de aprendizaje</span>
<span class="c1">#</span>
<span class="n">best_hyperband_hps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">),</span> <span class="n">best_hyperband_hps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(352, 0.001)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">best_randomsearch_hps</span> <span class="o">=</span> <span class="n">randomsearch_tuner</span><span class="o">.</span><span class="n">get_best_hyperparameters</span><span class="p">(</span><span class="n">num_trials</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#</span>
<span class="c1"># Cantidad optima de neuronas en la capa oculta</span>
<span class="c1"># y tasa de aprendizaje</span>
<span class="c1">#</span>
<span class="n">best_randomsearch_hps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">),</span> <span class="n">best_randomsearch_hps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(352, 0.0001)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">best_bayesianopt_hps</span> <span class="o">=</span> <span class="n">bayesianoptimization_tuner</span><span class="o">.</span><span class="n">get_best_hyperparameters</span><span class="p">(</span><span class="n">num_trials</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#</span>
<span class="c1"># Cantidad optima de neuronas en la capa oculta</span>
<span class="c1"># y tasa de aprendizaje</span>
<span class="c1">#</span>
<span class="n">best_bayesianopt_hps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">),</span> <span class="n">best_bayesianopt_hps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(512, 0.0001)
</pre></div></div>
</div>
</div>
<div class="section" id="Obtención-del-mejor-modelo">
<h2>Obtención del mejor modelo<a class="headerlink" href="#Obtención-del-mejor-modelo" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Construcción del modelo con los hiperparametros óptimos</span>
<span class="c1"># y entrenamiento para 50 epochs.</span>
<span class="c1">#</span>
<span class="c1"># Se busca obtener el número óptimo de epochs para</span>
<span class="c1"># entrenar el modelo</span>
<span class="c1">#</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">hyperband_tuner</span><span class="o">.</span><span class="n">hypermodel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">best_hyperband_hps</span><span class="p">)</span>

<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_images</span><span class="p">,</span>
    <span class="n">train_labels</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">val_acc_per_epoch</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;val_accuracy&quot;</span><span class="p">]</span>
<span class="n">best_epoch</span> <span class="o">=</span> <span class="n">val_acc_per_epoch</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">val_acc_per_epoch</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>

<span class="c1">#</span>
<span class="c1"># Número máximo de epochs usadas para entrenar el modelo</span>
<span class="c1">#</span>
<span class="n">best_epoch</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1/50
1500/1500 - 7s - loss: 0.5013 - accuracy: 0.8223 - val_loss: 0.4512 - val_accuracy: 0.8363
Epoch 2/50
1500/1500 - 6s - loss: 0.3725 - accuracy: 0.8647 - val_loss: 0.3723 - val_accuracy: 0.8633
Epoch 3/50
1500/1500 - 6s - loss: 0.3345 - accuracy: 0.8758 - val_loss: 0.3505 - val_accuracy: 0.8692
Epoch 4/50
1500/1500 - 6s - loss: 0.3068 - accuracy: 0.8862 - val_loss: 0.3516 - val_accuracy: 0.8733
Epoch 5/50
1500/1500 - 7s - loss: 0.2877 - accuracy: 0.8939 - val_loss: 0.3228 - val_accuracy: 0.8867
Epoch 6/50
1500/1500 - 7s - loss: 0.2733 - accuracy: 0.8983 - val_loss: 0.3235 - val_accuracy: 0.8851
Epoch 7/50
1500/1500 - 7s - loss: 0.2585 - accuracy: 0.9038 - val_loss: 0.3313 - val_accuracy: 0.8869
Epoch 8/50
1500/1500 - 7s - loss: 0.2444 - accuracy: 0.9088 - val_loss: 0.3223 - val_accuracy: 0.8842
Epoch 9/50
1500/1500 - 7s - loss: 0.2348 - accuracy: 0.9120 - val_loss: 0.3110 - val_accuracy: 0.8869
Epoch 10/50
1500/1500 - 7s - loss: 0.2263 - accuracy: 0.9141 - val_loss: 0.3177 - val_accuracy: 0.8886
Epoch 11/50
1500/1500 - 7s - loss: 0.2184 - accuracy: 0.9176 - val_loss: 0.3489 - val_accuracy: 0.8802
Epoch 12/50
1500/1500 - 7s - loss: 0.2093 - accuracy: 0.9222 - val_loss: 0.3253 - val_accuracy: 0.8900
Epoch 13/50
1500/1500 - 8s - loss: 0.2005 - accuracy: 0.9235 - val_loss: 0.3338 - val_accuracy: 0.8871
Epoch 14/50
1500/1500 - 7s - loss: 0.1943 - accuracy: 0.9274 - val_loss: 0.3297 - val_accuracy: 0.8899
Epoch 15/50
1500/1500 - 7s - loss: 0.1867 - accuracy: 0.9295 - val_loss: 0.3208 - val_accuracy: 0.8896
Epoch 16/50
1500/1500 - 7s - loss: 0.1817 - accuracy: 0.9309 - val_loss: 0.3461 - val_accuracy: 0.8895
Epoch 17/50
1500/1500 - 7s - loss: 0.1750 - accuracy: 0.9334 - val_loss: 0.3318 - val_accuracy: 0.8933
Epoch 18/50
1500/1500 - 7s - loss: 0.1673 - accuracy: 0.9372 - val_loss: 0.3477 - val_accuracy: 0.8892
Epoch 19/50
1500/1500 - 7s - loss: 0.1629 - accuracy: 0.9381 - val_loss: 0.3733 - val_accuracy: 0.8856
Epoch 20/50
1500/1500 - 7s - loss: 0.1587 - accuracy: 0.9404 - val_loss: 0.3753 - val_accuracy: 0.8873
Epoch 21/50
1500/1500 - 7s - loss: 0.1508 - accuracy: 0.9426 - val_loss: 0.3427 - val_accuracy: 0.8919
Epoch 22/50
1500/1500 - 7s - loss: 0.1479 - accuracy: 0.9448 - val_loss: 0.3756 - val_accuracy: 0.8868
Epoch 23/50
1500/1500 - 7s - loss: 0.1468 - accuracy: 0.9453 - val_loss: 0.3600 - val_accuracy: 0.8926
Epoch 24/50
1500/1500 - 8s - loss: 0.1391 - accuracy: 0.9479 - val_loss: 0.3690 - val_accuracy: 0.8901
Epoch 25/50
1500/1500 - 8s - loss: 0.1360 - accuracy: 0.9480 - val_loss: 0.3780 - val_accuracy: 0.8876
Epoch 26/50
1500/1500 - 7s - loss: 0.1317 - accuracy: 0.9499 - val_loss: 0.4010 - val_accuracy: 0.8902
Epoch 27/50
1500/1500 - 8s - loss: 0.1284 - accuracy: 0.9525 - val_loss: 0.3885 - val_accuracy: 0.8924
Epoch 28/50
1500/1500 - 7s - loss: 0.1276 - accuracy: 0.9516 - val_loss: 0.3884 - val_accuracy: 0.8907
Epoch 29/50
1500/1500 - 7s - loss: 0.1204 - accuracy: 0.9545 - val_loss: 0.3947 - val_accuracy: 0.8911
Epoch 30/50
1500/1500 - 6s - loss: 0.1177 - accuracy: 0.9560 - val_loss: 0.3880 - val_accuracy: 0.8915
Epoch 31/50
1500/1500 - 6s - loss: 0.1166 - accuracy: 0.9555 - val_loss: 0.4103 - val_accuracy: 0.8926
Epoch 32/50
1500/1500 - 6s - loss: 0.1139 - accuracy: 0.9560 - val_loss: 0.4244 - val_accuracy: 0.8903
Epoch 33/50
1500/1500 - 6s - loss: 0.1094 - accuracy: 0.9588 - val_loss: 0.4141 - val_accuracy: 0.8941
Epoch 34/50
1500/1500 - 6s - loss: 0.1065 - accuracy: 0.9606 - val_loss: 0.4398 - val_accuracy: 0.8928
Epoch 35/50
1500/1500 - 6s - loss: 0.1030 - accuracy: 0.9610 - val_loss: 0.4373 - val_accuracy: 0.8895
Epoch 36/50
1500/1500 - 5s - loss: 0.0994 - accuracy: 0.9624 - val_loss: 0.4385 - val_accuracy: 0.8943
Epoch 37/50
1500/1500 - 5s - loss: 0.0993 - accuracy: 0.9624 - val_loss: 0.4329 - val_accuracy: 0.8927
Epoch 38/50
1500/1500 - 6s - loss: 0.0974 - accuracy: 0.9631 - val_loss: 0.4696 - val_accuracy: 0.8892
Epoch 39/50
1500/1500 - 5s - loss: 0.0962 - accuracy: 0.9635 - val_loss: 0.4622 - val_accuracy: 0.8912
Epoch 40/50
1500/1500 - 5s - loss: 0.0923 - accuracy: 0.9650 - val_loss: 0.4654 - val_accuracy: 0.8920
Epoch 41/50
1500/1500 - 5s - loss: 0.0921 - accuracy: 0.9651 - val_loss: 0.4961 - val_accuracy: 0.8918
Epoch 42/50
1500/1500 - 5s - loss: 0.0888 - accuracy: 0.9661 - val_loss: 0.4946 - val_accuracy: 0.8887
Epoch 43/50
1500/1500 - 5s - loss: 0.0875 - accuracy: 0.9666 - val_loss: 0.4752 - val_accuracy: 0.8912
Epoch 44/50
1500/1500 - 5s - loss: 0.0846 - accuracy: 0.9679 - val_loss: 0.4740 - val_accuracy: 0.8948
Epoch 45/50
1500/1500 - 5s - loss: 0.0842 - accuracy: 0.9681 - val_loss: 0.4794 - val_accuracy: 0.8950
Epoch 46/50
1500/1500 - 5s - loss: 0.0832 - accuracy: 0.9686 - val_loss: 0.5057 - val_accuracy: 0.8922
Epoch 47/50
1500/1500 - 5s - loss: 0.0832 - accuracy: 0.9693 - val_loss: 0.5279 - val_accuracy: 0.8875
Epoch 48/50
1500/1500 - 5s - loss: 0.0767 - accuracy: 0.9713 - val_loss: 0.5340 - val_accuracy: 0.8913
Epoch 49/50
1500/1500 - 5s - loss: 0.0787 - accuracy: 0.9705 - val_loss: 0.5354 - val_accuracy: 0.8913
Epoch 50/50
1500/1500 - 5s - loss: 0.0740 - accuracy: 0.9723 - val_loss: 0.5612 - val_accuracy: 0.8889
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
45
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Reentrena el modelo usando el número óptimo de epochs</span>
<span class="c1">#</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">hyperband_tuner</span><span class="o">.</span><span class="n">hypermodel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">best_hyperband_hps</span><span class="p">)</span>

<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_images</span><span class="p">,</span>
    <span class="n">train_labels</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="n">best_epoch</span><span class="p">,</span>
    <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1/45
1500/1500 - 6s - loss: 0.5012 - accuracy: 0.8226 - val_loss: 0.4090 - val_accuracy: 0.8553
Epoch 2/45
1500/1500 - 5s - loss: 0.3721 - accuracy: 0.8645 - val_loss: 0.3534 - val_accuracy: 0.8719
Epoch 3/45
1500/1500 - 5s - loss: 0.3324 - accuracy: 0.8790 - val_loss: 0.3757 - val_accuracy: 0.8610
Epoch 4/45
1500/1500 - 5s - loss: 0.3071 - accuracy: 0.8873 - val_loss: 0.3847 - val_accuracy: 0.8598
Epoch 5/45
1500/1500 - 6s - loss: 0.2904 - accuracy: 0.8929 - val_loss: 0.3215 - val_accuracy: 0.8844
Epoch 6/45
1500/1500 - 5s - loss: 0.2705 - accuracy: 0.8994 - val_loss: 0.3312 - val_accuracy: 0.8784
Epoch 7/45
1500/1500 - 5s - loss: 0.2562 - accuracy: 0.9048 - val_loss: 0.3255 - val_accuracy: 0.8844
Epoch 8/45
1500/1500 - 5s - loss: 0.2463 - accuracy: 0.9075 - val_loss: 0.3328 - val_accuracy: 0.8824
Epoch 9/45
1500/1500 - 5s - loss: 0.2356 - accuracy: 0.9107 - val_loss: 0.3169 - val_accuracy: 0.8860
Epoch 10/45
1500/1500 - 5s - loss: 0.2242 - accuracy: 0.9156 - val_loss: 0.3410 - val_accuracy: 0.8790
Epoch 11/45
1500/1500 - 6s - loss: 0.2169 - accuracy: 0.9179 - val_loss: 0.3099 - val_accuracy: 0.8921
Epoch 12/45
1500/1500 - 5s - loss: 0.2077 - accuracy: 0.9220 - val_loss: 0.3262 - val_accuracy: 0.8931
Epoch 13/45
1500/1500 - 5s - loss: 0.1980 - accuracy: 0.9271 - val_loss: 0.3350 - val_accuracy: 0.8876
Epoch 14/45
1500/1500 - 5s - loss: 0.1933 - accuracy: 0.9271 - val_loss: 0.3401 - val_accuracy: 0.8897
Epoch 15/45
1500/1500 - 5s - loss: 0.1855 - accuracy: 0.9301 - val_loss: 0.3243 - val_accuracy: 0.8943
Epoch 16/45
1500/1500 - 5s - loss: 0.1799 - accuracy: 0.9329 - val_loss: 0.3399 - val_accuracy: 0.8903
Epoch 17/45
1500/1500 - 5s - loss: 0.1740 - accuracy: 0.9350 - val_loss: 0.3316 - val_accuracy: 0.8931
Epoch 18/45
1500/1500 - 5s - loss: 0.1669 - accuracy: 0.9365 - val_loss: 0.3327 - val_accuracy: 0.8955
Epoch 19/45
1500/1500 - 5s - loss: 0.1620 - accuracy: 0.9388 - val_loss: 0.3559 - val_accuracy: 0.8917
Epoch 20/45
1500/1500 - 5s - loss: 0.1577 - accuracy: 0.9407 - val_loss: 0.3551 - val_accuracy: 0.8875
Epoch 21/45
1500/1500 - 5s - loss: 0.1544 - accuracy: 0.9430 - val_loss: 0.3531 - val_accuracy: 0.8910
Epoch 22/45
1500/1500 - 5s - loss: 0.1473 - accuracy: 0.9454 - val_loss: 0.3562 - val_accuracy: 0.8970
Epoch 23/45
1500/1500 - 5s - loss: 0.1453 - accuracy: 0.9462 - val_loss: 0.3824 - val_accuracy: 0.8943
Epoch 24/45
1500/1500 - 5s - loss: 0.1400 - accuracy: 0.9472 - val_loss: 0.3584 - val_accuracy: 0.8964
Epoch 25/45
1500/1500 - 5s - loss: 0.1368 - accuracy: 0.9489 - val_loss: 0.3850 - val_accuracy: 0.8914
Epoch 26/45
1500/1500 - 5s - loss: 0.1335 - accuracy: 0.9502 - val_loss: 0.4495 - val_accuracy: 0.8855
Epoch 27/45
1500/1500 - 5s - loss: 0.1286 - accuracy: 0.9522 - val_loss: 0.4037 - val_accuracy: 0.8879
Epoch 28/45
1500/1500 - 5s - loss: 0.1228 - accuracy: 0.9546 - val_loss: 0.4066 - val_accuracy: 0.8840
Epoch 29/45
1500/1500 - 5s - loss: 0.1247 - accuracy: 0.9525 - val_loss: 0.4352 - val_accuracy: 0.8862
Epoch 30/45
1500/1500 - 5s - loss: 0.1189 - accuracy: 0.9561 - val_loss: 0.4178 - val_accuracy: 0.8907
Epoch 31/45
1500/1500 - 5s - loss: 0.1145 - accuracy: 0.9564 - val_loss: 0.4136 - val_accuracy: 0.8920
Epoch 32/45
1500/1500 - 5s - loss: 0.1130 - accuracy: 0.9571 - val_loss: 0.4139 - val_accuracy: 0.8959
Epoch 33/45
1500/1500 - 5s - loss: 0.1111 - accuracy: 0.9578 - val_loss: 0.4503 - val_accuracy: 0.8894
Epoch 34/45
1500/1500 - 5s - loss: 0.1082 - accuracy: 0.9597 - val_loss: 0.4272 - val_accuracy: 0.8911
Epoch 35/45
1500/1500 - 6s - loss: 0.1043 - accuracy: 0.9605 - val_loss: 0.4593 - val_accuracy: 0.8913
Epoch 36/45
1500/1500 - 5s - loss: 0.1030 - accuracy: 0.9614 - val_loss: 0.4433 - val_accuracy: 0.8928
Epoch 37/45
1500/1500 - 5s - loss: 0.0982 - accuracy: 0.9626 - val_loss: 0.4290 - val_accuracy: 0.8958
Epoch 38/45
1500/1500 - 5s - loss: 0.0992 - accuracy: 0.9625 - val_loss: 0.4270 - val_accuracy: 0.8946
Epoch 39/45
1500/1500 - 5s - loss: 0.0948 - accuracy: 0.9652 - val_loss: 0.4466 - val_accuracy: 0.8935
Epoch 40/45
1500/1500 - 6s - loss: 0.0944 - accuracy: 0.9655 - val_loss: 0.4682 - val_accuracy: 0.8924
Epoch 41/45
1500/1500 - 5s - loss: 0.0886 - accuracy: 0.9676 - val_loss: 0.4716 - val_accuracy: 0.8962
Epoch 42/45
1500/1500 - 5s - loss: 0.0908 - accuracy: 0.9667 - val_loss: 0.4626 - val_accuracy: 0.8972
Epoch 43/45
1500/1500 - 5s - loss: 0.0884 - accuracy: 0.9669 - val_loss: 0.4663 - val_accuracy: 0.8947
Epoch 44/45
1500/1500 - 5s - loss: 0.0841 - accuracy: 0.9689 - val_loss: 0.5069 - val_accuracy: 0.8932
Epoch 45/45
1500/1500 - 5s - loss: 0.0821 - accuracy: 0.9686 - val_loss: 0.4835 - val_accuracy: 0.8935
</pre></div></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2019-2021, Juan D. Velasquez.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>