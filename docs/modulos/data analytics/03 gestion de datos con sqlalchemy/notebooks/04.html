<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Procesamiento de datos usando engine y Pandas &mdash; documentación de Cursos de Analítica y Machine Learning - </title><link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/clipboard.min.js"></script>
        <script src="../../../../_static/copybutton.js"></script>
        <script src="../../../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Cursos de Analítica y Machine Learning
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" aria-label="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p><span class="caption-text">Asignaturas de Pregrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../cursos/redes-neuronales.html">Redes Neuronales Artificiales y Aprendizaje Profundo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cursos/fundamentos-de-analitica.html">Fundamentos de Analítica</a></li>
</ul>
<p><span class="caption-text">Asignaturas de Posgrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../cursos/ciencia-de-los-datos.html">Ciencia de los Datos Aplicada</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cursos/analitica-descriptiva.html">Analítica descriptiva y visualización de datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cursos/analitica-predictiva.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cursos/analitica-de-grandes-datos.html">Analítica de Grandes Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cursos/productos-de-datos.html">Productos de Datos</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Cursos de Analítica y Machine Learning</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Procesamiento de datos usando engine y Pandas</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/modulos/data analytics/03 gestion de datos con sqlalchemy/notebooks/04.ipynb.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Procesamiento-de-datos-usando-engine-y-Pandas">
<h1>Procesamiento de datos usando engine y Pandas<a class="headerlink" href="#Procesamiento-de-datos-usando-engine-y-Pandas" title="Enlazar permanentemente con este título"></a></h1>
<p><em>Diplomado en Analítica para Mercados de Energía</em></p>
<p>Este tutorial esta basado en <a class="reference external" href="https://es.hortonworks.com/tutorial/how-to-process-data-with-apache-hive/">https://es.hortonworks.com/tutorial/how-to-process-data-with-apache-hive/</a></p>
<section id="Fuentes-de-datos">
<h2>Fuentes de datos<a class="headerlink" href="#Fuentes-de-datos" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;drivers.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timesheet.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;truck_event_text_partition.csv&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/jdvelasq/datalabs/master/datasets/drivers/&quot;</span>

<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
    <span class="o">!</span>curl<span class="w"> </span>--silent<span class="w"> </span>-o<span class="w"> </span>/tmp/<span class="o">{</span>filename<span class="o">}</span><span class="w"> </span><span class="o">{</span>url<span class="w"> </span>+<span class="w"> </span>filename<span class="o">}</span>

<span class="o">!</span>ls<span class="w"> </span>-1<span class="w"> </span>/tmp/*.csv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/tmp/drivers.csv
/tmp/timesheet.csv
/tmp/truck_event_text_partition.csv
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Se imprime el final del archivo drivers</span>
<span class="c1">#</span>
<span class="o">!</span>tail<span class="w"> </span>-n<span class="w"> </span><span class="m">5</span><span class="w"> </span>/tmp/drivers.csv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
39,David Kaiser,967706052,9185 At Street,Y,hours
40,Nicolas Maillard,208510217,1027 Quis Rd.,Y,hours
41,Greg Phillips,308103116,P.O. Box 847- 5961 Arcu. Road,Y,hours
42,Randy Gelhausen,853302254,145-4200 In- Avenue,Y,hours
43,Dave Patton,977706052,3028 A- St.,Y,hours
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>tail<span class="w"> </span>-n<span class="w"> </span><span class="m">5</span><span class="w"> </span>/tmp/timesheet.csv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
43,48,52,2517
43,49,56,2743
43,50,59,2665
43,51,58,2593
43,52,48,2764
</pre></div></div>
</div>
</section>
<section id="Creación-de-la-máquina">
<h2>Creación de la máquina<a class="headerlink" href="#Creación-de-la-máquina" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="s2">&quot;sqlite+pysqlite:///:memory:&quot;</span><span class="p">,</span>
    <span class="n">echo</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">future</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Creación-y-carga-de-datos-de-datos-para-la-tabla-drivers-usando-pandas">
<h2>Creación y carga de datos de datos para la tabla <code class="docutils literal notranslate"><span class="pre">drivers</span></code> usando pandas<a class="headerlink" href="#Creación-y-carga-de-datos-de-datos-para-la-tabla-drivers-usando-pandas" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">drivers</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;/tmp/drivers.csv&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
    <span class="n">thousands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">decimal</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;latin-1&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">drivers</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">drivers</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

<span class="n">drivers</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span>
    <span class="s2">&quot;drivers&quot;</span><span class="p">,</span>
    <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span>
    <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span>
    <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
34
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Verificación</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.sql</span> <span class="kn">import</span> <span class="n">text</span>

<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT * FROM drivers LIMIT 5;</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span><span class="n">autocommit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">sql</span><span class="p">))</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>driverId</th>
      <th>name</th>
      <th>ssn</th>
      <th>location</th>
      <th>certified</th>
      <th>wage_plan</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>George Vetticaden</td>
      <td>621011971</td>
      <td>244-4532 Nulla Rd.</td>
      <td>N</td>
      <td>miles</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11</td>
      <td>Jamie Engesser</td>
      <td>262112338</td>
      <td>366-4125 Ac Street</td>
      <td>N</td>
      <td>miles</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>Paul Coddin</td>
      <td>198041975</td>
      <td>Ap #622-957 Risus. Street</td>
      <td>Y</td>
      <td>hours</td>
    </tr>
    <tr>
      <th>3</th>
      <td>13</td>
      <td>Joe Niemiec</td>
      <td>139907145</td>
      <td>2071 Hendrerit. Ave</td>
      <td>Y</td>
      <td>hours</td>
    </tr>
    <tr>
      <th>4</th>
      <td>14</td>
      <td>Adis Cesir</td>
      <td>820812209</td>
      <td>Ap #810-1228 In St.</td>
      <td>Y</td>
      <td>hours</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Extracción-de-datos-de-la-DB-con-Pandas">
<h2>Extracción de datos de la DB con Pandas<a class="headerlink" href="#Extracción-de-datos-de-la-DB-con-Pandas" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM drivers LIMIT 5;&quot;</span>

<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span><span class="n">autocommit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">query</span><span class="p">),</span> <span class="n">conn</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   driverId               name        ssn                   location  \
0        10  George Vetticaden  621011971         244-4532 Nulla Rd.
1        11     Jamie Engesser  262112338         366-4125 Ac Street
2        12        Paul Coddin  198041975  Ap #622-957 Risus. Street
3        13        Joe Niemiec  139907145        2071 Hendrerit. Ave
4        14         Adis Cesir  820812209        Ap #810-1228 In St.

  certified wage_plan
0         N     miles
1         N     miles
2         Y     hours
3         Y     hours
4         Y     hours
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span><span class="n">autocommit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="s2">&quot;drivers&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    driverId                 name        ssn  \
0         10    George Vetticaden  621011971
1         11       Jamie Engesser  262112338
2         12          Paul Coddin  198041975
3         13          Joe Niemiec  139907145
4         14           Adis Cesir  820812209
5         15         Rohit Bakshi  239005227
6         16           Tom McCuch  363303105
7         17          Eric Mizell  123808238
8         18            Grant Liu  171010151
9         19           Ajay Singh  160005158
10        20         Chris Harris  921812303
11        21         Jeff Markham  209408086
12        22        Nadeem Asghar  783204269
13        23            Adam Diaz  928312208
14        24          Don Hilborn  254412152
15        25  Jean-Philippe Playe  913310051
16        26         Michael Aube  124705141
17        27      Mark Lochbihler  392603159
18        28      Olivier Renault  959908181
19        29           Teddy Choi  185502192
20        30             Dan Rice  282307061
21        31        Rommel Garcia  858912101
22        32       Ryan Templeton  290304287
23        33    Sridhara Sabbella  967409015
24        34         Frank Romano  391407216
25        35          Emil Siemes  971401151
26        36        Andrew Grande  245303216
27        37            Wes Floyd  190504074
28        38           Scott Shaw  386411175
29        39         David Kaiser  967706052
30        40     Nicolas Maillard  208510217
31        41        Greg Phillips  308103116
32        42      Randy Gelhausen  853302254
33        43          Dave Patton  977706052

                              location certified wage_plan
0                   244-4532 Nulla Rd.         N     miles
1                   366-4125 Ac Street         N     miles
2            Ap #622-957 Risus. Street         Y     hours
3                  2071 Hendrerit. Ave         Y     hours
4                  Ap #810-1228 In St.         Y     hours
5                    648-5681 Dui- Rd.         Y     hours
6     P.O. Box 313- 962 Parturient Rd.         Y     hours
7   P.O. Box 579- 2191 Gravida. Street         Y     hours
8          Ap #928-3159 Vestibulum Av.         Y     hours
9              592-9430 Nonummy Avenue         Y     hours
10               883-2691 Proin Avenue         Y     hours
11          Ap #852-7966 Facilisis St.         Y     hours
12                154-9147 Aliquam Ave         Y     hours
13       P.O. Box 260- 6127 Vitae Road         Y     hours
14                        4361 Ac Road         Y     hours
15           P.O. Box 812- 6238 Ac Rd.         Y     hours
16          P.O. Box 213- 8948 Nec Ave         Y     hours
17                      8355 Ipsum St.         Y     hours
18     P.O. Box 243- 6509 Erat. Avenue         Y     hours
19         P.O. Box 106- 7003 Amet Rd.         Y     hours
20          Ap #881-9267 Mollis Avenue         Y     hours
21       P.O. Box 945- 6015 Sociis St.         Y     hours
22               765-6599 Egestas. Av.         Y     hours
23        Ap #477-2507 Sagittis Avenue         Y     hours
24               Ap #753-6814 Quis Ave         Y     hours
25                  321-2976 Felis Rd.         Y     hours
26            Ap #685-9598 Egestas Rd.         Y     hours
27     P.O. Box 269- 9611 Nulla Street         Y     hours
28                   276 Lobortis Road         Y     hours
29                      9185 At Street         Y     hours
30                       1027 Quis Rd.         Y     hours
31       P.O. Box 847- 5961 Arcu. Road         Y     hours
32                 145-4200 In- Avenue         Y     hours
33                         3028 A- St.         Y     hours
</pre></div></div>
</div>
</section>
<section id="Creación-y-carga-de-datos-de-la-tabla-timesheet">
<h2>Creación y carga de datos de la tabla <code class="docutils literal notranslate"><span class="pre">timesheet</span></code><a class="headerlink" href="#Creación-y-carga-de-datos-de-la-tabla-timesheet" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timesheet</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;/tmp/timesheet.csv&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
    <span class="n">thousands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">decimal</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;latin-1&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">timesheet</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">timesheet</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

<span class="n">timesheet</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span>
    <span class="s2">&quot;timesheet&quot;</span><span class="p">,</span>
    <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span>
    <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span>
    <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1768
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Verificación</span>
<span class="c1">#</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT * FROM timesheet LIMIT 5;</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span><span class="n">autocommit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">sql</span><span class="p">))</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>driverId</th>
      <th>week</th>
      <th>hours_logged</th>
      <th>miles_logged</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>1</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>2</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>3</td>
      <td>60</td>
      <td>2800</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>4</td>
      <td>70</td>
      <td>3100</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>5</td>
      <td>70</td>
      <td>3200</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Cantidad-de-horas-y-millas-de-cada-conductor-por-año.">
<h2>Cantidad de horas y millas de cada conductor por año.<a class="headerlink" href="#Cantidad-de-horas-y-millas-de-cada-conductor-por-año." title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT</span>
<span class="s2">    driverId,</span>
<span class="s2">    sum(hours_logged),</span>
<span class="s2">    sum(miles_logged)</span>
<span class="s2">FROM</span>
<span class="s2">    timesheet</span>
<span class="s2">GROUP BY</span>
<span class="s2">    driverId;</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span><span class="n">autocommit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">sql</span><span class="p">))</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>driverId</th>
      <th>sum(hours_logged)</th>
      <th>sum(miles_logged)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>3232</td>
      <td>147150</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11</td>
      <td>3642</td>
      <td>179300</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>2639</td>
      <td>135962</td>
    </tr>
    <tr>
      <th>3</th>
      <td>13</td>
      <td>2727</td>
      <td>134126</td>
    </tr>
    <tr>
      <th>4</th>
      <td>14</td>
      <td>2781</td>
      <td>136624</td>
    </tr>
    <tr>
      <th>5</th>
      <td>15</td>
      <td>2734</td>
      <td>138750</td>
    </tr>
    <tr>
      <th>6</th>
      <td>16</td>
      <td>2746</td>
      <td>137205</td>
    </tr>
    <tr>
      <th>7</th>
      <td>17</td>
      <td>2701</td>
      <td>135992</td>
    </tr>
    <tr>
      <th>8</th>
      <td>18</td>
      <td>2654</td>
      <td>137834</td>
    </tr>
    <tr>
      <th>9</th>
      <td>19</td>
      <td>2738</td>
      <td>137968</td>
    </tr>
    <tr>
      <th>10</th>
      <td>20</td>
      <td>2644</td>
      <td>134564</td>
    </tr>
    <tr>
      <th>11</th>
      <td>21</td>
      <td>2751</td>
      <td>138719</td>
    </tr>
    <tr>
      <th>12</th>
      <td>22</td>
      <td>2733</td>
      <td>137550</td>
    </tr>
    <tr>
      <th>13</th>
      <td>23</td>
      <td>2750</td>
      <td>137980</td>
    </tr>
    <tr>
      <th>14</th>
      <td>24</td>
      <td>2647</td>
      <td>134461</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25</td>
      <td>2723</td>
      <td>139180</td>
    </tr>
    <tr>
      <th>16</th>
      <td>26</td>
      <td>2730</td>
      <td>137530</td>
    </tr>
    <tr>
      <th>17</th>
      <td>27</td>
      <td>2771</td>
      <td>137922</td>
    </tr>
    <tr>
      <th>18</th>
      <td>28</td>
      <td>2723</td>
      <td>137469</td>
    </tr>
    <tr>
      <th>19</th>
      <td>29</td>
      <td>2760</td>
      <td>138255</td>
    </tr>
    <tr>
      <th>20</th>
      <td>30</td>
      <td>2773</td>
      <td>137473</td>
    </tr>
    <tr>
      <th>21</th>
      <td>31</td>
      <td>2704</td>
      <td>137057</td>
    </tr>
    <tr>
      <th>22</th>
      <td>32</td>
      <td>2736</td>
      <td>137422</td>
    </tr>
    <tr>
      <th>23</th>
      <td>33</td>
      <td>2759</td>
      <td>139285</td>
    </tr>
    <tr>
      <th>24</th>
      <td>34</td>
      <td>2811</td>
      <td>137728</td>
    </tr>
    <tr>
      <th>25</th>
      <td>35</td>
      <td>2728</td>
      <td>138727</td>
    </tr>
    <tr>
      <th>26</th>
      <td>36</td>
      <td>2795</td>
      <td>138025</td>
    </tr>
    <tr>
      <th>27</th>
      <td>37</td>
      <td>2694</td>
      <td>137223</td>
    </tr>
    <tr>
      <th>28</th>
      <td>38</td>
      <td>2760</td>
      <td>137464</td>
    </tr>
    <tr>
      <th>29</th>
      <td>39</td>
      <td>2745</td>
      <td>138788</td>
    </tr>
    <tr>
      <th>30</th>
      <td>40</td>
      <td>2700</td>
      <td>136931</td>
    </tr>
    <tr>
      <th>31</th>
      <td>41</td>
      <td>2723</td>
      <td>138407</td>
    </tr>
    <tr>
      <th>32</th>
      <td>42</td>
      <td>2697</td>
      <td>136673</td>
    </tr>
    <tr>
      <th>33</th>
      <td>43</td>
      <td>2750</td>
      <td>136993</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Subconsultas">
<h2>Subconsultas<a class="headerlink" href="#Subconsultas" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Selecciona todos los registros de la tabla timesheet</span>
<span class="c1"># que tienen el driverId igual al menor driverId de la</span>
<span class="c1"># tabla drivers.</span>
<span class="c1">#</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT</span>
<span class="s2">    *</span>
<span class="s2">FROM</span>
<span class="s2">    timesheet</span>
<span class="s2">WHERE</span>
<span class="s2">    driverId = (SELECT min(driverId) FROM drivers);</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span><span class="n">autocommit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">sql</span><span class="p">))</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>driverId</th>
      <th>week</th>
      <th>hours_logged</th>
      <th>miles_logged</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>1</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>2</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>3</td>
      <td>60</td>
      <td>2800</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>4</td>
      <td>70</td>
      <td>3100</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>5</td>
      <td>70</td>
      <td>3200</td>
    </tr>
    <tr>
      <th>5</th>
      <td>10</td>
      <td>6</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10</td>
      <td>7</td>
      <td>70</td>
      <td>3000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10</td>
      <td>8</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10</td>
      <td>9</td>
      <td>70</td>
      <td>3200</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>10</td>
      <td>50</td>
      <td>2500</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>11</td>
      <td>70</td>
      <td>2900</td>
    </tr>
    <tr>
      <th>11</th>
      <td>10</td>
      <td>12</td>
      <td>70</td>
      <td>3100</td>
    </tr>
    <tr>
      <th>12</th>
      <td>10</td>
      <td>13</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>13</th>
      <td>10</td>
      <td>14</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>14</th>
      <td>10</td>
      <td>15</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>15</th>
      <td>10</td>
      <td>16</td>
      <td>70</td>
      <td>3400</td>
    </tr>
    <tr>
      <th>16</th>
      <td>10</td>
      <td>17</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>17</th>
      <td>10</td>
      <td>18</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>18</th>
      <td>10</td>
      <td>19</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>19</th>
      <td>10</td>
      <td>20</td>
      <td>30</td>
      <td>1200</td>
    </tr>
    <tr>
      <th>20</th>
      <td>10</td>
      <td>21</td>
      <td>50</td>
      <td>2500</td>
    </tr>
    <tr>
      <th>21</th>
      <td>10</td>
      <td>22</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>22</th>
      <td>10</td>
      <td>23</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>23</th>
      <td>10</td>
      <td>24</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>24</th>
      <td>10</td>
      <td>25</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>25</th>
      <td>10</td>
      <td>26</td>
      <td>60</td>
      <td>2600</td>
    </tr>
    <tr>
      <th>26</th>
      <td>10</td>
      <td>27</td>
      <td>66</td>
      <td>2700</td>
    </tr>
    <tr>
      <th>27</th>
      <td>10</td>
      <td>28</td>
      <td>33</td>
      <td>1200</td>
    </tr>
    <tr>
      <th>28</th>
      <td>10</td>
      <td>29</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>29</th>
      <td>10</td>
      <td>30</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10</td>
      <td>31</td>
      <td>72</td>
      <td>3100</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10</td>
      <td>32</td>
      <td>70</td>
      <td>3200</td>
    </tr>
    <tr>
      <th>32</th>
      <td>10</td>
      <td>33</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>33</th>
      <td>10</td>
      <td>34</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>34</th>
      <td>10</td>
      <td>35</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>10</td>
      <td>36</td>
      <td>19</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>36</th>
      <td>10</td>
      <td>37</td>
      <td>65</td>
      <td>2700</td>
    </tr>
    <tr>
      <th>37</th>
      <td>10</td>
      <td>38</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>38</th>
      <td>10</td>
      <td>39</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>39</th>
      <td>10</td>
      <td>40</td>
      <td>70</td>
      <td>3100</td>
    </tr>
    <tr>
      <th>40</th>
      <td>10</td>
      <td>41</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>41</th>
      <td>10</td>
      <td>42</td>
      <td>70</td>
      <td>3100</td>
    </tr>
    <tr>
      <th>42</th>
      <td>10</td>
      <td>43</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>43</th>
      <td>10</td>
      <td>44</td>
      <td>70</td>
      <td>3300</td>
    </tr>
    <tr>
      <th>44</th>
      <td>10</td>
      <td>45</td>
      <td>65</td>
      <td>2700</td>
    </tr>
    <tr>
      <th>45</th>
      <td>10</td>
      <td>46</td>
      <td>57</td>
      <td>2300</td>
    </tr>
    <tr>
      <th>46</th>
      <td>10</td>
      <td>47</td>
      <td>74</td>
      <td>3400</td>
    </tr>
    <tr>
      <th>47</th>
      <td>10</td>
      <td>48</td>
      <td>76</td>
      <td>3400</td>
    </tr>
    <tr>
      <th>48</th>
      <td>10</td>
      <td>49</td>
      <td>68</td>
      <td>2800</td>
    </tr>
    <tr>
      <th>49</th>
      <td>10</td>
      <td>50</td>
      <td>72</td>
      <td>2900</td>
    </tr>
    <tr>
      <th>50</th>
      <td>10</td>
      <td>51</td>
      <td>5</td>
      <td>150</td>
    </tr>
    <tr>
      <th>51</th>
      <td>10</td>
      <td>52</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Consulta-para-unir-las-tablas">
<h2>Consulta para unir las tablas<a class="headerlink" href="#Consulta-para-unir-las-tablas" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT</span>
<span class="s2">    d.driverId,</span>
<span class="s2">    d.name,</span>
<span class="s2">    t.total_hours,</span>
<span class="s2">    t.total_miles</span>
<span class="s2">FROM</span>
<span class="s2">    drivers d</span>
<span class="s2">JOIN (</span>
<span class="s2">    SELECT</span>
<span class="s2">        driverId,</span>
<span class="s2">        sum(hours_logged)total_hours,</span>
<span class="s2">        sum(miles_logged)total_miles</span>
<span class="s2">    FROM</span>
<span class="s2">        timesheet</span>
<span class="s2">    GROUP BY</span>
<span class="s2">        driverId</span>
<span class="s2">    ) t</span>
<span class="s2">ON</span>
<span class="s2">    (d.driverId = t.driverId);</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span><span class="n">autocommit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">sql</span><span class="p">))</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>driverId</th>
      <th>name</th>
      <th>total_hours</th>
      <th>total_miles</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>George Vetticaden</td>
      <td>3232</td>
      <td>147150</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11</td>
      <td>Jamie Engesser</td>
      <td>3642</td>
      <td>179300</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>Paul Coddin</td>
      <td>2639</td>
      <td>135962</td>
    </tr>
    <tr>
      <th>3</th>
      <td>13</td>
      <td>Joe Niemiec</td>
      <td>2727</td>
      <td>134126</td>
    </tr>
    <tr>
      <th>4</th>
      <td>14</td>
      <td>Adis Cesir</td>
      <td>2781</td>
      <td>136624</td>
    </tr>
    <tr>
      <th>5</th>
      <td>15</td>
      <td>Rohit Bakshi</td>
      <td>2734</td>
      <td>138750</td>
    </tr>
    <tr>
      <th>6</th>
      <td>16</td>
      <td>Tom McCuch</td>
      <td>2746</td>
      <td>137205</td>
    </tr>
    <tr>
      <th>7</th>
      <td>17</td>
      <td>Eric Mizell</td>
      <td>2701</td>
      <td>135992</td>
    </tr>
    <tr>
      <th>8</th>
      <td>18</td>
      <td>Grant Liu</td>
      <td>2654</td>
      <td>137834</td>
    </tr>
    <tr>
      <th>9</th>
      <td>19</td>
      <td>Ajay Singh</td>
      <td>2738</td>
      <td>137968</td>
    </tr>
    <tr>
      <th>10</th>
      <td>20</td>
      <td>Chris Harris</td>
      <td>2644</td>
      <td>134564</td>
    </tr>
    <tr>
      <th>11</th>
      <td>21</td>
      <td>Jeff Markham</td>
      <td>2751</td>
      <td>138719</td>
    </tr>
    <tr>
      <th>12</th>
      <td>22</td>
      <td>Nadeem Asghar</td>
      <td>2733</td>
      <td>137550</td>
    </tr>
    <tr>
      <th>13</th>
      <td>23</td>
      <td>Adam Diaz</td>
      <td>2750</td>
      <td>137980</td>
    </tr>
    <tr>
      <th>14</th>
      <td>24</td>
      <td>Don Hilborn</td>
      <td>2647</td>
      <td>134461</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25</td>
      <td>Jean-Philippe Playe</td>
      <td>2723</td>
      <td>139180</td>
    </tr>
    <tr>
      <th>16</th>
      <td>26</td>
      <td>Michael Aube</td>
      <td>2730</td>
      <td>137530</td>
    </tr>
    <tr>
      <th>17</th>
      <td>27</td>
      <td>Mark Lochbihler</td>
      <td>2771</td>
      <td>137922</td>
    </tr>
    <tr>
      <th>18</th>
      <td>28</td>
      <td>Olivier Renault</td>
      <td>2723</td>
      <td>137469</td>
    </tr>
    <tr>
      <th>19</th>
      <td>29</td>
      <td>Teddy Choi</td>
      <td>2760</td>
      <td>138255</td>
    </tr>
    <tr>
      <th>20</th>
      <td>30</td>
      <td>Dan Rice</td>
      <td>2773</td>
      <td>137473</td>
    </tr>
    <tr>
      <th>21</th>
      <td>31</td>
      <td>Rommel Garcia</td>
      <td>2704</td>
      <td>137057</td>
    </tr>
    <tr>
      <th>22</th>
      <td>32</td>
      <td>Ryan Templeton</td>
      <td>2736</td>
      <td>137422</td>
    </tr>
    <tr>
      <th>23</th>
      <td>33</td>
      <td>Sridhara Sabbella</td>
      <td>2759</td>
      <td>139285</td>
    </tr>
    <tr>
      <th>24</th>
      <td>34</td>
      <td>Frank Romano</td>
      <td>2811</td>
      <td>137728</td>
    </tr>
    <tr>
      <th>25</th>
      <td>35</td>
      <td>Emil Siemes</td>
      <td>2728</td>
      <td>138727</td>
    </tr>
    <tr>
      <th>26</th>
      <td>36</td>
      <td>Andrew Grande</td>
      <td>2795</td>
      <td>138025</td>
    </tr>
    <tr>
      <th>27</th>
      <td>37</td>
      <td>Wes Floyd</td>
      <td>2694</td>
      <td>137223</td>
    </tr>
    <tr>
      <th>28</th>
      <td>38</td>
      <td>Scott Shaw</td>
      <td>2760</td>
      <td>137464</td>
    </tr>
    <tr>
      <th>29</th>
      <td>39</td>
      <td>David Kaiser</td>
      <td>2745</td>
      <td>138788</td>
    </tr>
    <tr>
      <th>30</th>
      <td>40</td>
      <td>Nicolas Maillard</td>
      <td>2700</td>
      <td>136931</td>
    </tr>
    <tr>
      <th>31</th>
      <td>41</td>
      <td>Greg Phillips</td>
      <td>2723</td>
      <td>138407</td>
    </tr>
    <tr>
      <th>32</th>
      <td>42</td>
      <td>Randy Gelhausen</td>
      <td>2697</td>
      <td>136673</td>
    </tr>
    <tr>
      <th>33</th>
      <td>43</td>
      <td>Dave Patton</td>
      <td>2750</td>
      <td>136993</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Conductor con más horas registradas</span>
<span class="c1">#</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT</span>
<span class="s2">    d.driverId,</span>
<span class="s2">    d.name,</span>
<span class="s2">    t.total_hours,</span>
<span class="s2">    t.total_miles</span>
<span class="s2">FROM</span>
<span class="s2">    drivers d</span>
<span class="s2">JOIN (</span>
<span class="s2">    SELECT</span>
<span class="s2">        driverId,</span>
<span class="s2">        sum(hours_logged)total_hours,</span>
<span class="s2">        sum(miles_logged)total_miles</span>
<span class="s2">    FROM</span>
<span class="s2">        timesheet</span>
<span class="s2">    GROUP BY</span>
<span class="s2">        driverId</span>
<span class="s2">    ) t</span>
<span class="s2">ON</span>
<span class="s2">    (d.driverId = t.driverId)</span>
<span class="s2">ORDER BY</span>
<span class="s2">    t.total_hours DESC</span>
<span class="s2">LIMIT 1;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span><span class="n">autocommit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">sql</span><span class="p">))</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>driverId</th>
      <th>name</th>
      <th>total_hours</th>
      <th>total_miles</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>Jamie Engesser</td>
      <td>3642</td>
      <td>179300</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Creación-de-un-DataFrame-usando-una-consulta">
<h2>Creación de un DataFrame usando una consulta<a class="headerlink" href="#Creación-de-un-DataFrame-usando-una-consulta" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT</span>
<span class="s2">    d.driverId,</span>
<span class="s2">    d.name,</span>
<span class="s2">    t.total_hours,</span>
<span class="s2">    t.total_miles</span>
<span class="s2">FROM</span>
<span class="s2">    drivers d</span>
<span class="s2">JOIN (</span>
<span class="s2">    SELECT</span>
<span class="s2">        driverId,</span>
<span class="s2">        sum(hours_logged) total_hours,</span>
<span class="s2">        sum(miles_logged) total_miles</span>
<span class="s2">    FROM</span>
<span class="s2">        timesheet</span>
<span class="s2">    GROUP BY</span>
<span class="s2">        driverId</span>
<span class="s2">    ) t</span>
<span class="s2">ON</span>
<span class="s2">    (d.driverId = t.driverId)</span>
<span class="s2">ORDER BY</span>
<span class="s2">    t.total_hours DESC;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span><span class="n">autocommit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">sql</span><span class="p">))</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>


<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;total_hours&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ModuleNotFoundError</span>                       Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [30], line 31</span>
<span class="ansi-green-intense-fg ansi-bold">     26</span>     query = conn.execute(text(sql))
<span class="ansi-green-intense-fg ansi-bold">     28</span> df = pd.DataFrame(query.fetchall())
<span class="ansi-green-fg">---&gt; 31</span> import matplotlib as mpl
<span class="ansi-green-intense-fg ansi-bold">     32</span> import matplotlib.pyplot as plt
<span class="ansi-green-intense-fg ansi-bold">     34</span> df.plot.bar(x=&#34;name&#34;, y=&#34;total_hours&#34;)

<span class="ansi-red-fg">ModuleNotFoundError</span>: No module named &#39;matplotlib&#39;
</pre></div></div>
</div>
</section>
<section id="Almacenamiento-de-los-resultados">
<h2>Almacenamiento de los resultados<a class="headerlink" href="#Almacenamiento-de-los-resultados" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT</span>
<span class="s2">    d.driverId,</span>
<span class="s2">    d.name,</span>
<span class="s2">    t.total_hours,</span>
<span class="s2">    t.total_miles</span>
<span class="s2">FROM</span>
<span class="s2">    drivers d</span>
<span class="s2">JOIN (</span>
<span class="s2">    SELECT</span>
<span class="s2">        driverId,</span>
<span class="s2">        sum(hours_logged) total_hours,</span>
<span class="s2">        sum(miles_logged) total_miles</span>
<span class="s2">    FROM</span>
<span class="s2">        timesheet</span>
<span class="s2">    GROUP BY</span>
<span class="s2">        driverId</span>
<span class="s2">    ) t</span>
<span class="s2">ON</span>
<span class="s2">    (d.driverId = t.driverId)</span>
<span class="s2">ORDER BY</span>
<span class="s2">    d.name;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span><span class="n">autocommit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">sql</span><span class="p">))</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;/tmp/summary.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>head<span class="w"> </span>/tmp/summary.csv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
driverId,name,total_hours,total_miles
23,Adam Diaz,2750,137980
14,Adis Cesir,2781,136624
19,Ajay Singh,2738,137968
36,Andrew Grande,2795,138025
20,Chris Harris,2644,134564
30,Dan Rice,2773,137473
43,Dave Patton,2750,136993
39,David Kaiser,2745,138788
24,Don Hilborn,2647,134461
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2019-2021, Juan D. Velasquez.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>