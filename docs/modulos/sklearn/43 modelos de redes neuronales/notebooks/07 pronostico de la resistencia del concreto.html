<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Predicción de la resistencia del concreto usando redes neuronales &mdash; documentación de Cursos de Analítica y Machine Learning - </title><link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/clipboard.min.js"></script>
        <script src="../../../../_static/copybutton.js"></script>
        <script src="../../../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Cursos de Analítica y Machine Learning
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" aria-label="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p><span class="caption-text">Asignaturas de Pregrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../asignaturas/redes-neuronales.html">Redes Neuronales Artificiales y Aprendizaje Profundo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../asignaturas/fundamentos-de-analitica.html">Fundamentos de Analítica</a></li>
</ul>
<p><span class="caption-text">Asignaturas de Posgrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../asignaturas/ciencia-de-los-datos.html">Ciencia de los Datos Aplicada</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../asignaturas/analitica-descriptiva.html">Analítica descriptiva y visualización de datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../asignaturas/analitica-predictiva.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../asignaturas/analitica-de-grandes-datos.html">Analítica de Grandes Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../asignaturas/productos-de-datos.html">Productos de Datos</a></li>
</ul>
<p><span class="caption-text">Cursos</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../cursos/DA_con_Python.html">Data Analytics con Python</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Cursos de Analítica y Machine Learning</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Predicción de la resistencia del concreto usando redes neuronales</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/modulos/sklearn/43 modelos de redes neuronales/notebooks/07 pronostico de la resistencia del concreto.ipynb.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Predicción-de-la-resistencia-del-concreto-usando-redes-neuronales">
<h1>Predicción de la resistencia del concreto usando redes neuronales<a class="headerlink" href="#Predicción-de-la-resistencia-del-concreto-usando-redes-neuronales" title="Enlazar permanentemente con este título"></a></h1>
<ul class="simple">
<li><p><strong>Contexto.</strong> El concreto es uno de los materiales más usados en construcción. Es fabricado por la mezcla de varios elementos, la cual, al secarse, forma una masa dura muy resistente a la compresión. Uno de los principales problemas es que la mezcla puede demorarse varios meses en secar, y resulta particularmente importante el poder realizar pronósticos de la resistencia que alcanzará, tanto para fines de control como para verificar las restricciones de diseño.</p></li>
</ul>
<ul class="simple">
<li><p>La muestra contiene 1030 mediciones de concretos con ocho características que decriben los componentes usados en la mezcla. Se piensa que estas ocho características tienen una relación no lineal con la resistencia a la compresión final que tiene el concreto.</p></li>
</ul>
<ul class="simple">
<li><p>Se desea construir un modelo de redes neuronales usando las siguientes variables.</p>
<ul>
<li><p>Cement (component 1) [Cemento] – quantitative – kg in a m3 mixture – Input Variable</p></li>
<li><p>Bla st Furnace Slag [Ceniza] (component 2) – quantitative – kg in a m3 mixture – Input Variable</p></li>
<li><p>Fly Ash (component 3) [Ceniza] – quantitative – kg in a m3 mixture – Input Variable</p></li>
<li><p>Water (component 4) [Agua] – quantitative – kg in a m3 mixture – Input Variable</p></li>
<li><p>Superplasticizer (component 5) [Plastificador] – quantitative – kg in a m3 mixture – Input Variable</p></li>
<li><p>Coarse Aggregate (component 6) [Agregado grueso] – quantitative – kg in a m3 mixture – Input Variable</p></li>
<li><p>Fine Aggregate (component 7) [Agregado fino] – quantitative – kg in a m3 mixture – Input Variable</p></li>
<li><p>Age – quantitative – Day (1~365) [Edad] – Input Variable</p></li>
<li><p>Concrete compressive strength [Resistencia a la compresión] – quantitative – MPa – Output Variable</p></li>
</ul>
</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/jdvelasq/datalabs/master/datasets/concrete.csv&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>  <span class="c1"># separador de campos</span>
    <span class="n">thousands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># separador de miles para números</span>
    <span class="n">decimal</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
<span class="p">)</span>  <span class="c1"># separador de los decimales para números</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cement</th>
      <th>slag</th>
      <th>ash</th>
      <th>water</th>
      <th>superplastic</th>
      <th>coarseagg</th>
      <th>fineagg</th>
      <th>age</th>
      <th>strength</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>540.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>162.0</td>
      <td>2.5</td>
      <td>1040.0</td>
      <td>676.0</td>
      <td>28</td>
      <td>79.99</td>
    </tr>
    <tr>
      <th>1</th>
      <td>540.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>162.0</td>
      <td>2.5</td>
      <td>1055.0</td>
      <td>676.0</td>
      <td>28</td>
      <td>61.89</td>
    </tr>
    <tr>
      <th>2</th>
      <td>332.5</td>
      <td>142.5</td>
      <td>0.0</td>
      <td>228.0</td>
      <td>0.0</td>
      <td>932.0</td>
      <td>594.0</td>
      <td>270</td>
      <td>40.27</td>
    </tr>
    <tr>
      <th>3</th>
      <td>332.5</td>
      <td>142.5</td>
      <td>0.0</td>
      <td>228.0</td>
      <td>0.0</td>
      <td>932.0</td>
      <td>594.0</td>
      <td>365</td>
      <td>41.05</td>
    </tr>
    <tr>
      <th>4</th>
      <td>198.6</td>
      <td>132.4</td>
      <td>0.0</td>
      <td>192.0</td>
      <td>0.0</td>
      <td>978.4</td>
      <td>825.5</td>
      <td>360</td>
      <td>44.30</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1">#</span>
<span class="c1"># Los rangos de las variables numéricas son bastantes diferentes</span>
<span class="c1">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/modulos_sklearn_43_modelos_de_redes_neuronales_notebooks_07_pronostico_de_la_resistencia_del_concreto_5_0.png" src="../../../../_images/modulos_sklearn_43_modelos_de_redes_neuronales_notebooks_07_pronostico_de_la_resistencia_del_concreto_5_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">strength</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/modulos_sklearn_43_modelos_de_redes_neuronales_notebooks_07_pronostico_de_la_resistencia_del_concreto_6_0.png" src="../../../../_images/modulos_sklearn_43_modelos_de_redes_neuronales_notebooks_07_pronostico_de_la_resistencia_del_concreto_6_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">strength</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.04</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.04</span> <span class="o">*</span> <span class="n">y</span><span class="p">)))</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
    <span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/modulos_sklearn_43_modelos_de_redes_neuronales_notebooks_07_pronostico_de_la_resistencia_del_concreto_7_0.png" src="../../../../_images/modulos_sklearn_43_modelos_de_redes_neuronales_notebooks_07_pronostico_de_la_resistencia_del_concreto_7_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectKBest</span><span class="p">,</span> <span class="n">f_regression</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;scaler&quot;</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s2">&quot;selectKBest&quot;</span><span class="p">,</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">score_func</span><span class="o">=</span><span class="n">f_regression</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;mlp&quot;</span><span class="p">,</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">early_stopping</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">TransformedTargetRegressor</span>

<span class="n">transformedTargetRegressor</span> <span class="o">=</span> <span class="n">TransformedTargetRegressor</span><span class="p">(</span>
    <span class="n">regressor</span><span class="o">=</span><span class="n">pipeline</span><span class="p">,</span>
    <span class="n">func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.04</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.04</span> <span class="o">*</span> <span class="n">z</span><span class="p">)),</span>
    <span class="n">inverse_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">z</span><span class="p">))</span> <span class="o">/</span> <span class="mf">0.04</span><span class="p">,</span>
    <span class="n">check_inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;regressor__selectKBest__k&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span>
    <span class="s2">&quot;regressor__mlp__hidden_layer_sizes&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="n">i</span><span class="p">,)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)],</span>
    <span class="s2">&quot;regressor__mlp__activation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;logistic&quot;</span><span class="p">,</span> <span class="s2">&quot;relu&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">gridSearchCV</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">transformedTargetRegressor</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;neg_mean_squared_error&quot;</span><span class="p">,</span>
    <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;strength&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;strength&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cement</th>
      <th>slag</th>
      <th>ash</th>
      <th>water</th>
      <th>superplastic</th>
      <th>coarseagg</th>
      <th>fineagg</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>540.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>162.0</td>
      <td>2.5</td>
      <td>1040.0</td>
      <td>676.0</td>
      <td>28</td>
    </tr>
    <tr>
      <th>1</th>
      <td>540.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>162.0</td>
      <td>2.5</td>
      <td>1055.0</td>
      <td>676.0</td>
      <td>28</td>
    </tr>
    <tr>
      <th>2</th>
      <td>332.5</td>
      <td>142.5</td>
      <td>0.0</td>
      <td>228.0</td>
      <td>0.0</td>
      <td>932.0</td>
      <td>594.0</td>
      <td>270</td>
    </tr>
    <tr>
      <th>3</th>
      <td>332.5</td>
      <td>142.5</td>
      <td>0.0</td>
      <td>228.0</td>
      <td>0.0</td>
      <td>932.0</td>
      <td>594.0</td>
      <td>365</td>
    </tr>
    <tr>
      <th>4</th>
      <td>198.6</td>
      <td>132.4</td>
      <td>0.0</td>
      <td>192.0</td>
      <td>0.0</td>
      <td>978.4</td>
      <td>825.5</td>
      <td>360</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1025</th>
      <td>276.4</td>
      <td>116.0</td>
      <td>90.3</td>
      <td>179.6</td>
      <td>8.9</td>
      <td>870.1</td>
      <td>768.3</td>
      <td>28</td>
    </tr>
    <tr>
      <th>1026</th>
      <td>322.2</td>
      <td>0.0</td>
      <td>115.6</td>
      <td>196.0</td>
      <td>10.4</td>
      <td>817.9</td>
      <td>813.4</td>
      <td>28</td>
    </tr>
    <tr>
      <th>1027</th>
      <td>148.5</td>
      <td>139.4</td>
      <td>108.6</td>
      <td>192.7</td>
      <td>6.1</td>
      <td>892.4</td>
      <td>780.0</td>
      <td>28</td>
    </tr>
    <tr>
      <th>1028</th>
      <td>159.1</td>
      <td>186.7</td>
      <td>0.0</td>
      <td>175.6</td>
      <td>11.3</td>
      <td>989.6</td>
      <td>788.9</td>
      <td>28</td>
    </tr>
    <tr>
      <th>1029</th>
      <td>260.9</td>
      <td>100.5</td>
      <td>78.3</td>
      <td>200.6</td>
      <td>8.6</td>
      <td>864.5</td>
      <td>761.5</td>
      <td>28</td>
    </tr>
  </tbody>
</table>
<p>1030 rows × 8 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gridSearchCV</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/tmp/ipykernel_11840/1129733630.py:6: RuntimeWarning: invalid value encountered in log
  inverse_func=lambda z: np.log(1 / (1 - z)) / 0.04,
/usr/local/lib/python3.8/dist-packages/sklearn/model_selection/_validation.py:776: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details:
Traceback (most recent call last):
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/model_selection/_validation.py&#34;, line 767, in _score
    scores = scorer(estimator, X_test, y_test)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_scorer.py&#34;, line 220, in __call__
    return self._score(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_scorer.py&#34;, line 268, in _score
    return self._sign * self._score_func(y_true, y_pred, **self._kwargs)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_regression.py&#34;, line 442, in mean_squared_error
    y_type, y_true, y_pred, multioutput = _check_reg_targets(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_regression.py&#34;, line 102, in _check_reg_targets
    y_pred = check_array(y_pred, ensure_2d=False, dtype=dtype)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/utils/validation.py&#34;, line 919, in check_array
    _assert_all_finite(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/utils/validation.py&#34;, line 161, in _assert_all_finite
    raise ValueError(msg_err)
ValueError: Input contains NaN.

  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/tmp/ipykernel_11840/1129733630.py:6: RuntimeWarning: invalid value encountered in log
  inverse_func=lambda z: np.log(1 / (1 - z)) / 0.04,
/usr/local/lib/python3.8/dist-packages/sklearn/model_selection/_validation.py:776: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details:
Traceback (most recent call last):
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/model_selection/_validation.py&#34;, line 767, in _score
    scores = scorer(estimator, X_test, y_test)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_scorer.py&#34;, line 220, in __call__
    return self._score(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_scorer.py&#34;, line 268, in _score
    return self._sign * self._score_func(y_true, y_pred, **self._kwargs)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_regression.py&#34;, line 442, in mean_squared_error
    y_type, y_true, y_pred, multioutput = _check_reg_targets(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_regression.py&#34;, line 102, in _check_reg_targets
    y_pred = check_array(y_pred, ensure_2d=False, dtype=dtype)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/utils/validation.py&#34;, line 919, in check_array
    _assert_all_finite(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/utils/validation.py&#34;, line 161, in _assert_all_finite
    raise ValueError(msg_err)
ValueError: Input contains NaN.

  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/tmp/ipykernel_11840/1129733630.py:6: RuntimeWarning: invalid value encountered in log
  inverse_func=lambda z: np.log(1 / (1 - z)) / 0.04,
/usr/local/lib/python3.8/dist-packages/sklearn/model_selection/_validation.py:776: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details:
Traceback (most recent call last):
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/model_selection/_validation.py&#34;, line 767, in _score
    scores = scorer(estimator, X_test, y_test)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_scorer.py&#34;, line 220, in __call__
    return self._score(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_scorer.py&#34;, line 268, in _score
    return self._sign * self._score_func(y_true, y_pred, **self._kwargs)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_regression.py&#34;, line 442, in mean_squared_error
    y_type, y_true, y_pred, multioutput = _check_reg_targets(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_regression.py&#34;, line 102, in _check_reg_targets
    y_pred = check_array(y_pred, ensure_2d=False, dtype=dtype)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/utils/validation.py&#34;, line 919, in check_array
    _assert_all_finite(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/utils/validation.py&#34;, line 161, in _assert_all_finite
    raise ValueError(msg_err)
ValueError: Input contains NaN.

  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/tmp/ipykernel_11840/1129733630.py:6: RuntimeWarning: invalid value encountered in log
  inverse_func=lambda z: np.log(1 / (1 - z)) / 0.04,
/usr/local/lib/python3.8/dist-packages/sklearn/model_selection/_validation.py:776: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details:
Traceback (most recent call last):
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/model_selection/_validation.py&#34;, line 767, in _score
    scores = scorer(estimator, X_test, y_test)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_scorer.py&#34;, line 220, in __call__
    return self._score(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_scorer.py&#34;, line 268, in _score
    return self._sign * self._score_func(y_true, y_pred, **self._kwargs)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_regression.py&#34;, line 442, in mean_squared_error
    y_type, y_true, y_pred, multioutput = _check_reg_targets(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_regression.py&#34;, line 102, in _check_reg_targets
    y_pred = check_array(y_pred, ensure_2d=False, dtype=dtype)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/utils/validation.py&#34;, line 919, in check_array
    _assert_all_finite(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/utils/validation.py&#34;, line 161, in _assert_all_finite
    raise ValueError(msg_err)
ValueError: Input contains NaN.

  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
/tmp/ipykernel_11840/1129733630.py:6: RuntimeWarning: invalid value encountered in log
  inverse_func=lambda z: np.log(1 / (1 - z)) / 0.04,
/usr/local/lib/python3.8/dist-packages/sklearn/model_selection/_validation.py:776: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details:
Traceback (most recent call last):
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/model_selection/_validation.py&#34;, line 767, in _score
    scores = scorer(estimator, X_test, y_test)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_scorer.py&#34;, line 220, in __call__
    return self._score(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_scorer.py&#34;, line 268, in _score
    return self._sign * self._score_func(y_true, y_pred, **self._kwargs)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_regression.py&#34;, line 442, in mean_squared_error
    y_type, y_true, y_pred, multioutput = _check_reg_targets(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/metrics/_regression.py&#34;, line 102, in _check_reg_targets
    y_pred = check_array(y_pred, ensure_2d=False, dtype=dtype)
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/utils/validation.py&#34;, line 919, in check_array
    _assert_all_finite(
  File &#34;/usr/local/lib/python3.8/dist-packages/sklearn/utils/validation.py&#34;, line 161, in _assert_all_finite
    raise ValueError(msg_err)
ValueError: Input contains NaN.

  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/model_selection/_search.py:953: UserWarning: One or more of the test scores are non-finite: [-167.76211986           nan]
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/preprocessing/_function_transformer.py:184: UserWarning: The provided functions are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;.
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/compose/_target.py:190: UserWarning: The provided functions or transformer are not strictly inverse of each other. If you are sure you want to proceed regardless, set &#39;check_inverse=False&#39;
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=10,
             estimator=TransformedTargetRegressor(func=&lt;function &lt;lambda&gt; at 0x7f08d26c4ee0&gt;,
                                                  inverse_func=&lt;function &lt;lambda&gt; at 0x7f08d26c4dc0&gt;,
                                                  regressor=Pipeline(steps=[(&#x27;scaler&#x27;,
                                                                             MinMaxScaler()),
                                                                            (&#x27;selectKBest&#x27;,
                                                                             SelectKBest(score_func=&lt;function f_regression at 0x7f08d3a30700&gt;)),
                                                                            (&#x27;mlp&#x27;,
                                                                             MLPRegressor(early_stopping=True,
                                                                                          max_iter=20000))])),
             param_grid={&#x27;regressor__mlp__activation&#x27;: [&#x27;logistic&#x27;, &#x27;relu&#x27;],
                         &#x27;regressor__mlp__hidden_layer_sizes&#x27;: [(4,)],
                         &#x27;regressor__selectKBest__k&#x27;: [8]},
             scoring=&#x27;neg_mean_squared_error&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox" ><label for="sk-estimator-id-7" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=10,
             estimator=TransformedTargetRegressor(func=&lt;function &lt;lambda&gt; at 0x7f08d26c4ee0&gt;,
                                                  inverse_func=&lt;function &lt;lambda&gt; at 0x7f08d26c4dc0&gt;,
                                                  regressor=Pipeline(steps=[(&#x27;scaler&#x27;,
                                                                             MinMaxScaler()),
                                                                            (&#x27;selectKBest&#x27;,
                                                                             SelectKBest(score_func=&lt;function f_regression at 0x7f08d3a30700&gt;)),
                                                                            (&#x27;mlp&#x27;,
                                                                             MLPRegressor(early_stopping=True,
                                                                                          max_iter=20000))])),
             param_grid={&#x27;regressor__mlp__activation&#x27;: [&#x27;logistic&#x27;, &#x27;relu&#x27;],
                         &#x27;regressor__mlp__hidden_layer_sizes&#x27;: [(4,)],
                         &#x27;regressor__selectKBest__k&#x27;: [8]},
             scoring=&#x27;neg_mean_squared_error&#x27;)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox" ><label for="sk-estimator-id-8" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: TransformedTargetRegressor</label><div class="sk-toggleable__content"><pre>TransformedTargetRegressor(func=&lt;function &lt;lambda&gt; at 0x7f08d26c4ee0&gt;,
                           inverse_func=&lt;function &lt;lambda&gt; at 0x7f08d26c4dc0&gt;,
                           regressor=Pipeline(steps=[(&#x27;scaler&#x27;, MinMaxScaler()),
                                                     (&#x27;selectKBest&#x27;,
                                                      SelectKBest(score_func=&lt;function f_regression at 0x7f08d3a30700&gt;)),
                                                     (&#x27;mlp&#x27;,
                                                      MLPRegressor(early_stopping=True,
                                                                   max_iter=20000))]))</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox" ><label for="sk-estimator-id-9" class="sk-toggleable__label sk-toggleable__label-arrow">regressor: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scaler&#x27;, MinMaxScaler()),
                (&#x27;selectKBest&#x27;,
                 SelectKBest(score_func=&lt;function f_regression at 0x7f08d3a30700&gt;)),
                (&#x27;mlp&#x27;, MLPRegressor(early_stopping=True, max_iter=20000))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-10" type="checkbox" ><label for="sk-estimator-id-10" class="sk-toggleable__label sk-toggleable__label-arrow">MinMaxScaler</label><div class="sk-toggleable__content"><pre>MinMaxScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-11" type="checkbox" ><label for="sk-estimator-id-11" class="sk-toggleable__label sk-toggleable__label-arrow">SelectKBest</label><div class="sk-toggleable__content"><pre>SelectKBest(score_func=&lt;function f_regression at 0x7f08d3a30700&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-12" type="checkbox" ><label for="sk-estimator-id-12" class="sk-toggleable__label sk-toggleable__label-arrow">MLPRegressor</label><div class="sk-toggleable__content"><pre>MLPRegressor(early_stopping=True, max_iter=20000)</pre></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gridSearchCV</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;regressor__mlp__activation&#39;: &#39;logistic&#39;,
 &#39;regressor__mlp__hidden_layer_sizes&#39;: (4,),
 &#39;regressor__selectKBest__k&#39;: 8}
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">gridSearchCV</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">y_test_pred</span> <span class="o">=</span> <span class="n">gridSearchCV</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mean squared error: </span><span class="si">{</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span><span class="w"> </span><span class="n">y_train_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      Variance score: </span><span class="si">{</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span><span class="w"> </span><span class="n">y_train_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mean squared error: </span><span class="si">{</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_test_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      Variance score: </span><span class="si">{</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_test_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Train:
  Mean squared error: 163.51
      Variance score: 0.41

Test:
  Mean squared error: 184.08
      Variance score: 0.34
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">def</span> <span class="nf">plot_forecasts</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;y true&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y pred&quot;</span><span class="p">)</span>
    <span class="n">x_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="s2">&quot;k-&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_forecasts</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/modulos_sklearn_43_modelos_de_redes_neuronales_notebooks_07_pronostico_de_la_resistencia_del_concreto_20_0.png" src="../../../../_images/modulos_sklearn_43_modelos_de_redes_neuronales_notebooks_07_pronostico_de_la_resistencia_del_concreto_20_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_forecasts</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/modulos_sklearn_43_modelos_de_redes_neuronales_notebooks_07_pronostico_de_la_resistencia_del_concreto_21_0.png" src="../../../../_images/modulos_sklearn_43_modelos_de_redes_neuronales_notebooks_07_pronostico_de_la_resistencia_del_concreto_21_0.png" />
</div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2019-2021, Juan D. Velasquez.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>